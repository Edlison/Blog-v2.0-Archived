<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/man-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/man-16x16.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.1/css/all.min.css">

<script class="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"blog.edlison.com","root":"/","images":"/images","scheme":"Muse","version":"8.0.2","exturl":true,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":false,"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"motion":{"enable":false,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}};
  </script>

  <meta name="description" content="Edlison blog">
<meta property="og:type" content="website">
<meta property="og:title" content="Edlison is talking here.">
<meta property="og:url" content="https://blog.edlison.com/page/59/index.html">
<meta property="og:site_name" content="Edlison is talking here.">
<meta property="og:description" content="Edlison blog">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Bolin Shen">
<meta property="article:tag" content="Edlison">
<meta property="article:tag" content="edlison">
<meta property="article:tag" content="blog">
<meta property="article:tag" content="code">
<meta property="article:tag" content="solution">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://blog.edlison.com/page/59/">


<script class="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'en'
  };
</script>

  <title>Edlison is talking here. - â€œEdlison's blogâ€</title>
  
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-NC6FWQJNCW"></script>
    <script>
      if (CONFIG.hostname === location.hostname) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-NC6FWQJNCW');
      }
    </script>






  <noscript>
  <style>
  body { margin-top: 2rem; }

  .use-motion .menu-item,
  .use-motion .sidebar,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header {
    visibility: visible;
  }

  .use-motion .header,
  .use-motion .site-brand-container .toggle,
  .use-motion .footer { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle,
  .use-motion .custom-logo-image {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line {
    transform: scaleX(1);
  }

  .search-pop-overlay, .sidebar-nav { display: none; }
  .sidebar-panel { display: block; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">Edlison is talking here.</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">â€œEdlison's blogâ€</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
  </ul>
</nav>




</div>
        
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <section class="post-toc-wrap sidebar-panel">
        </section>
        <!--/noindex-->

        <section class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Bolin Shen</p>
  <div class="site-description" itemprop="description">Edlison blog</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">347</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">31</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">180</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2VkbGlzb24=" title="GitHub â†’ https:&#x2F;&#x2F;github.com&#x2F;edlison"><i class="fab fa-github fa-fw"></i>GitHub</span>
      </span>
      <span class="links-of-author-item">
        <span class="exturl" data-url="bWFpbHRvOmJvbGluLmVkbGlzb24uc2hlbkBnbWFpbC5jb20=" title="E-Mail â†’ mailto:bolin.edlison.shen@gmail.com"><i class="fa fa-envelope fa-fw"></i>E-Mail</span>
      </span>
  </div>



        </section>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner index posts-expand">
      

      
    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="https://blog.edlison.com/dev/ml/deep_learning/week-1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Bolin Shen">
      <meta itemprop="description" content="Edlison blog">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Edlison is talking here.">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/dev/ml/deep_learning/week-1/" class="post-title-link" itemprop="url">NLPæ–‡æœ¬åˆ†ç±»å¼•å¯¼</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 07-14-2020 23:31:04" itemprop="dateCreated datePublished" datetime="2020-07-14T23:31:04+08:00">07-14-2020</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">Edited on</span>
        <time title="Modified: 01-26-2021 17:25:12" itemprop="dateModified" datetime="2021-01-26T17:25:12+08:00">01-26-2021</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Notebook/" itemprop="url" rel="index"><span itemprop="name">Notebook</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="NLPæ–‡æœ¬åˆ†ç±»å¼•å¯¼"><a href="#NLPæ–‡æœ¬åˆ†ç±»å¼•å¯¼" class="headerlink" title="NLPæ–‡æœ¬åˆ†ç±»å¼•å¯¼"></a>NLPæ–‡æœ¬åˆ†ç±»å¼•å¯¼</h1><h2 id="en"><a href="#en" class="headerlink" title="en"></a>en</h2><h2 id="1-æ•°æ®è¯»å–"><a href="#1-æ•°æ®è¯»å–" class="headerlink" title="1. æ•°æ®è¯»å–"></a>1. æ•°æ®è¯»å–</h2><h3 id="pythonåŸç”Ÿè¯»å–txtæ–‡ä»¶"><a href="#pythonåŸç”Ÿè¯»å–txtæ–‡ä»¶" class="headerlink" title="pythonåŸç”Ÿè¯»å–txtæ–‡ä»¶"></a>pythonåŸç”Ÿè¯»å–txtæ–‡ä»¶</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">f = open(filedir, mode=<span class="string">'r'</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li><code>f.read()</code>ä¸€æ¬¡è¯»å–å…¨éƒ¨æ•°æ®ã€‚</li>
<li><code>f.readline()</code>åˆ†è¡Œè¯»å–ï¼Œä¸€æ¬¡è¯»å–ä¸€è¡Œã€‚</li>
<li><code>f.readlines()</code>è¯»å–å…¨éƒ¨æ•°æ®ï¼Œä¿ç•™<code>\n</code>æ¢è¡Œç¬¦ã€‚</li>
</ul>
<h3 id="pandasè¯»å–txtæ–‡ä»¶"><a href="#pandasè¯»å–txtæ–‡ä»¶" class="headerlink" title="pandasè¯»å–txtæ–‡ä»¶"></a>pandasè¯»å–txtæ–‡ä»¶</h3><p>pd.read_table(filedir, splitsign, header=æŒ‡å®šç¬¬å‡ è¡Œä¸ºåˆ—å, names=å¦‚æœæ²¡æœ‰åˆ—åæ‰‹åŠ¨æŒ‡å®š[â€˜xâ€™, â€˜yâ€™])</p>
<h2 id="2-æ•°æ®é¢„å¤„ç†"><a href="#2-æ•°æ®é¢„å¤„ç†" class="headerlink" title="2. æ•°æ®é¢„å¤„ç†"></a>2. æ•°æ®é¢„å¤„ç†</h2><h3 id="åˆ†è¯"><a href="#åˆ†è¯" class="headerlink" title="åˆ†è¯"></a>åˆ†è¯</h3><h3 id="å»é™¤åœè¯-å»é™¤ä½é¢‘è¯"><a href="#å»é™¤åœè¯-å»é™¤ä½é¢‘è¯" class="headerlink" title="å»é™¤åœè¯ å»é™¤ä½é¢‘è¯"></a>å»é™¤åœè¯ å»é™¤ä½é¢‘è¯</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">optimize_words_dict</span><span class="params">(self, data, stop_words, threshold)</span>:</span></span><br><span class="line">    freq_dict = &#123;&#125;</span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> data:  <span class="comment"># å»é™¤åœè¯ + è®¡ç®—è¯é¢‘</span></span><br><span class="line">        <span class="keyword">for</span> word <span class="keyword">in</span> line:</span><br><span class="line">            <span class="keyword">if</span> word <span class="keyword">in</span> stop_words:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="keyword">if</span> word <span class="keyword">not</span> <span class="keyword">in</span> freq_dict:</span><br><span class="line">                freq_dict[word] = <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                freq_dict[word] += <span class="number">1</span></span><br><span class="line">    words_list = []</span><br><span class="line">    values = sorted(list(set(freq_dict.values())), reverse=<span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">for</span> w <span class="keyword">in</span> values:  <span class="comment"># é€šè¿‡é˜ˆå€¼ç­›é€‰è¯è¡¨ ç®—æ³•å¯ä»¥ä¼˜åŒ–ï¼Ÿï¼Ÿï¼Ÿ</span></span><br><span class="line">        <span class="keyword">if</span> w &lt; threshold:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">for</span> k, v <span class="keyword">in</span> freq_dict.items():</span><br><span class="line">            <span class="keyword">if</span> v == w:</span><br><span class="line">                words_list.append((k, v))</span><br><span class="line">    <span class="keyword">return</span> words_list</span><br></pre></td></tr></table></figure>

<h3 id="é€šè¿‡TF-IDFç®—æ³•ç­›é€‰å•è¯"><a href="#é€šè¿‡TF-IDFç®—æ³•ç­›é€‰å•è¯" class="headerlink" title="é€šè¿‡TF-IDFç®—æ³•ç­›é€‰å•è¯"></a>é€šè¿‡TF-IDFç®—æ³•ç­›é€‰å•è¯</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">tf_idf</span><span class="params">(self, data)</span>:</span></span><br><span class="line">    doc_num = len(data)</span><br><span class="line">    df = &#123;&#125;</span><br><span class="line">    <span class="keyword">for</span> sample <span class="keyword">in</span> data:</span><br><span class="line">        <span class="keyword">for</span> word <span class="keyword">in</span> set(sample):  <span class="comment"># é¿å…ä¸€ä¸ªå•è¯åœ¨ä¸€ä¸ªSampleé‡Œå‡ºç°å¤šæ¬¡</span></span><br><span class="line">            <span class="keyword">if</span> word <span class="keyword">not</span> <span class="keyword">in</span> df:</span><br><span class="line">                df[word] = <span class="number">1.0</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                df[word] += <span class="number">1.0</span></span><br><span class="line">    <span class="keyword">for</span> word <span class="keyword">in</span> df:  <span class="comment"># è®¡ç®—document frequency æ–‡æ¡£æ€»æ•°/å•è¯å‡ºç°è¿‡çš„æ–‡æ¡£æ•°</span></span><br><span class="line">        df[word] = log10(doc_num / df[word])</span><br><span class="line">    res = &#123;&#125;</span><br><span class="line">    index = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> sample <span class="keyword">in</span> data:</span><br><span class="line">        res[index] = &#123;&#125;</span><br><span class="line">        tf = &#123;&#125;</span><br><span class="line">        <span class="keyword">for</span> word <span class="keyword">in</span> sample:  <span class="comment"># è®¡ç®—term frequency ä¸€ä¸ªæ ·æœ¬é‡Œå•è¯çš„é¢‘ç‡</span></span><br><span class="line">            <span class="keyword">if</span> word <span class="keyword">not</span> <span class="keyword">in</span> tf:</span><br><span class="line">                tf[word] = <span class="number">1.0</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                tf[word] += <span class="number">1.0</span></span><br><span class="line">        sample_len = len(sample)</span><br><span class="line">        <span class="keyword">for</span> word <span class="keyword">in</span> sample:  <span class="comment"># è®¡ç®—tf * idf ä¸€ä¸ªæ ·æœ¬ä¸­å„å•è¯çš„tf_idf</span></span><br><span class="line">            tf_idf = tf[word] / sample_len * df[word]</span><br><span class="line">            res[index][word] = tf_idf</span><br><span class="line">        index += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> res  <span class="comment"># resæ ¼å¼ä¸ºæ¯ä¸€ä¸ªæ ·æœ¬ä¸­æ¯ä¸€ä¸ªå•è¯å¯¹åº”çš„tf_idfå€¼</span></span><br></pre></td></tr></table></figure>

<p><strong>åœ¨é¢„å¤„ç†æ—¶ï¼Œå› ä¸ºæ˜¯è¦ä¸ºç”Ÿæˆè¯å…¸åšå‡†å¤‡ï¼Œæ‰€ä»¥TF-IDFåº”è¯¥æ˜¯ä»¥æ•´ä¸ªcorpusè®¡ç®—TFï¼Œè€Œæå–ç‰¹å¾æ—¶å»ºç«‹è¯è¢‹æ¨¡å‹ä¸­çš„TF-IDFæ–¹æ³•åˆ™æ˜¯å¯¹æ¯ä¸ªSampleçš„å•è¯è®¡ç®—TF-IDFå€¼ã€‚</strong></p>
<h2 id="3-å»ºç«‹è¯å…¸"><a href="#3-å»ºç«‹è¯å…¸" class="headerlink" title="3. å»ºç«‹è¯å…¸"></a>3. å»ºç«‹è¯å…¸</h2><p>è¯å…¸ = {â€˜å•è¯â€™:ç´¢å¼•}</p>
<h2 id="4-æå–ç‰¹å¾"><a href="#4-æå–ç‰¹å¾" class="headerlink" title="4. æå–ç‰¹å¾"></a>4. æå–ç‰¹å¾</h2><h3 id="è¯è¢‹æ¨¡å‹ï¼ˆBOWï¼‰"><a href="#è¯è¢‹æ¨¡å‹ï¼ˆBOWï¼‰" class="headerlink" title="è¯è¢‹æ¨¡å‹ï¼ˆBOWï¼‰"></a>è¯è¢‹æ¨¡å‹ï¼ˆBOWï¼‰</h3><p>å‡è®¾å»ºç«‹çš„è¯å…¸æœ‰1000ç»´ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°†ä¸ºæ•°æ®é›†ä¸­çš„æ¯ä¸€ä¸ªSampleå»ºç«‹ä¸€ä¸ª1000ç»´çš„å‘é‡ã€‚</p>
<p>è¯è¢‹æ¨¡å‹æœ‰ä¸‰ç§å½¢å¼ï¼š</p>
<ul>
<li>å¯¹äºæ¯ä¸ªSmapleå•è¯æ˜¯å¦å‡ºç°</li>
<li>å¯¹äºæ¯ä¸ªSampleå•è¯å‡ºç°æ¬¡æ•°</li>
<li>å¯¹äºæ¯ä¸ªSmapleå•è¯çš„TF-IDFå€¼</li>
</ul>
<p><strong>åœ¨é¢„å¤„ç†æ—¶ï¼Œå› ä¸ºæ˜¯è¦ä¸ºç”Ÿæˆè¯å…¸åšå‡†å¤‡ï¼Œæ‰€ä»¥TF-IDFåº”è¯¥æ˜¯ä»¥æ•´ä¸ªcorpusè®¡ç®—TFï¼Œè€Œæå–ç‰¹å¾æ—¶å»ºç«‹è¯è¢‹æ¨¡å‹ä¸­çš„TF-IDFæ–¹æ³•åˆ™æ˜¯å¯¹æ¯ä¸ªSampleçš„å•è¯è®¡ç®—TF-IDFå€¼ã€‚</strong></p>
<p>ä¾‹ï¼š<br>è¯å…¸ï¼š1000. [åŒ—äº¬ï¼Œå¤©æ°”ï¼ŒçœŸï¼Œå¥½ï¼ŒåŒ—äº¬] = [0, 1, 0, â€¦,0], æˆ– [0, 2, 0, â€¦,0]ï¼Œæˆ– [0, 0.4, 0, â€¦, 0]</p>
<h4 id="ç‹¬çƒ­ç¼–ç ï¼ˆOne-Hotï¼‰"><a href="#ç‹¬çƒ­ç¼–ç ï¼ˆOne-Hotï¼‰" class="headerlink" title="ç‹¬çƒ­ç¼–ç ï¼ˆOne-Hotï¼‰"></a>ç‹¬çƒ­ç¼–ç ï¼ˆOne-Hotï¼‰</h4><p>å¯¹äºä¸€ä¸ªç‰¹å¾æœ‰Nä¸ªçŠ¶æ€åˆ™å¯ä»¥ç”¨Nä½æ¥è¡¨ç¤º</p>
<p>ä¾‹ï¼šFeature_2æœ‰2ä¸ªçŠ¶æ€</p>
<p>Sample_1 = [0, 1], Sample_2 = [1, 0] â€¦</p>
<p>ä¾‹ï¼šFeature_1æœ‰4ä¸ªçŠ¶æ€</p>
<p>Sample_1 = [0, 0, 1, 0], Sample_2 = [0, 1, 0, 0] â€¦</p>
<p>å½“ä¸€ä¸ªæ ·æœ¬æœ‰å¤šä¸ªçŠ¶æ€æ—¶</p>
<p>Sample_1 = [0, 1, 0, 0, 1, 0], Sample_2 = [1, 0, 0, 1, 0, 0] â€¦</p>
<hr>
<p>ä¸€ç‚¹æƒ³æ³•<br>ä¸ç¡®å®šåº”è¯¥å»ºç«‹å¤šå¤§çš„è¯å…¸æ—¶ï¼Œå¯ä»¥è€ƒè™‘Corpusçš„å¤§å°æˆ–æ˜¯æ¯ä¸ªSampleä¸­Wordçš„ä¸ªæ•°<br>è¯å…¸çš„å¤§å°å°±ä¸Corpusæˆ–Sampleä¸­Wordçš„ä¸ªæ•°æˆæŸä¸ªæ¯”ä¾‹</p>
<h2 id="zh"><a href="#zh" class="headerlink" title="zh"></a>zh</h2><h2 id="1-æ•°æ®å¤„ç†"><a href="#1-æ•°æ®å¤„ç†" class="headerlink" title="1. æ•°æ®å¤„ç†"></a>1. æ•°æ®å¤„ç†</h2><ul>
<li>å»é™¤ç©ºæ ¼</li>
<li>ç¬¦å·è½¬æ¢ï¼ˆçœç•¥å·-&gt;å¥å·ï¼‰ï¼Ÿ</li>
<li>å»é™¤æ— æ„ä¹‰ç¬¦å·</li>
<li>ç¹ä½“è½¬æ¢ç®€ä½“</li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="https://blog.edlison.com/dev/ml/KNN-%E6%89%8B%E5%86%99%E4%BD%93%E6%95%B0%E5%AD%97%E6%95%B0%E6%8D%AE%E9%9B%86/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Bolin Shen">
      <meta itemprop="description" content="Edlison blog">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Edlison is talking here.">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/dev/ml/KNN-%E6%89%8B%E5%86%99%E4%BD%93%E6%95%B0%E5%AD%97%E6%95%B0%E6%8D%AE%E9%9B%86/" class="post-title-link" itemprop="url">dev/ml/KNN-æ‰‹å†™ä½“æ•°å­—æ•°æ®é›†</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 05-17-2020 16:37:20 / Modified: 16:38:09" itemprop="dateCreated datePublished" datetime="2020-05-17T16:37:20+08:00">05-17-2020</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="KNN-æ‰‹å†™ä½“æ•°å­—æ•°æ®é›†"><a href="#KNN-æ‰‹å†™ä½“æ•°å­—æ•°æ®é›†" class="headerlink" title="KNN-æ‰‹å†™ä½“æ•°å­—æ•°æ®é›†"></a>KNN-æ‰‹å†™ä½“æ•°å­—æ•°æ®é›†</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> datasets</span><br><span class="line"><span class="keyword">from</span> sklearn.neighbors <span class="keyword">import</span> KNeighborsClassifier</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">digits = datasets.load_digits()</span><br><span class="line">X = digits.data</span><br><span class="line">X.shape</span><br></pre></td></tr></table></figure>




<pre><code>(1797, 64)</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">y = digits.target</span><br><span class="line">y.shape</span><br></pre></td></tr></table></figure>




<pre><code>(1797,)</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">one = X[<span class="number">100</span>]</span><br><span class="line">one = one.reshape(<span class="number">8</span>, <span class="number">8</span>)</span><br><span class="line">one</span><br></pre></td></tr></table></figure>




<pre><code>array([[ 0.,  0.,  0.,  2., 13.,  0.,  0.,  0.],
       [ 0.,  0.,  0.,  8., 15.,  0.,  0.,  0.],
       [ 0.,  0.,  5., 16.,  5.,  2.,  0.,  0.],
       [ 0.,  0., 15., 12.,  1., 16.,  4.,  0.],
       [ 0.,  4., 16.,  2.,  9., 16.,  8.,  0.],
       [ 0.,  0., 10., 14., 16., 16.,  4.,  0.],
       [ 0.,  0.,  0.,  0., 13.,  8.,  0.,  0.],
       [ 0.,  0.,  0.,  0., 13.,  6.,  0.,  0.]])</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">plt.imshow(one)</span><br></pre></td></tr></table></figure>




<pre><code>&lt;matplotlib.image.AxesImage at 0x1a203a9ad0&gt;</code></pre><p><img src="data/output_5_1.png" alt="png"></p>
<h1 id="åˆ†ç¦»è®­ç»ƒæµ‹è¯•é›†"><a href="#åˆ†ç¦»è®­ç»ƒæµ‹è¯•é›†" class="headerlink" title="åˆ†ç¦»è®­ç»ƒæµ‹è¯•é›†"></a>åˆ†ç¦»è®­ç»ƒæµ‹è¯•é›†</h1><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</span><br><span class="line">train_test_split?</span><br></pre></td></tr></table></figure>


<pre><code>[0;31mSignature:[0m [0mtrain_test_split[0m[0;34m([0m[0;34m*[0m[0marrays[0m[0;34m,[0m [0;34m**[0m[0moptions[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[0;31mDocstring:[0m
Split arrays or matrices into random train and test subsets

Quick utility that wraps input validation and
``next(ShuffleSplit().split(X, y))`` and application to input data
into a single call for splitting (and optionally subsampling) data in a
oneliner.

Read more in the :ref:`User Guide &lt;cross_validation&gt;`.

Parameters
----------
*arrays : sequence of indexables with same length / shape[0]
    Allowed inputs are lists, numpy arrays, scipy-sparse
    matrices or pandas dataframes.

test_size : float, int or None, optional (default=None)
    If float, should be between 0.0 and 1.0 and represent the proportion
    of the dataset to include in the test split. If int, represents the
    absolute number of test samples. If None, the value is set to the
    complement of the train size. If ``train_size`` is also None, it will
    be set to 0.25.

train_size : float, int, or None, (default=None)
    If float, should be between 0.0 and 1.0 and represent the
    proportion of the dataset to include in the train split. If
    int, represents the absolute number of train samples. If None,
    the value is automatically set to the complement of the test size.

random_state : int, RandomState instance or None, optional (default=None)
    If int, random_state is the seed used by the random number generator;
    If RandomState instance, random_state is the random number generator;
    If None, the random number generator is the RandomState instance used
    by `np.random`.

shuffle : boolean, optional (default=True)
    Whether or not to shuffle the data before splitting. If shuffle=False
    then stratify must be None.

stratify : array-like or None (default=None)
    If not None, data is split in a stratified fashion, using this as
    the class labels.

Returns
-------
splitting : list, length=2 * len(arrays)
    List containing train-test split of inputs.

    .. versionadded:: 0.16
        If the input is sparse, the output will be a
        ``scipy.sparse.csr_matrix``. Else, output type is the same as the
        input type.

Examples
--------
&gt;&gt;&gt; import numpy as np
&gt;&gt;&gt; from sklearn.model_selection import train_test_split
&gt;&gt;&gt; X, y = np.arange(10).reshape((5, 2)), range(5)
&gt;&gt;&gt; X
array([[0, 1],
       [2, 3],
       [4, 5],
       [6, 7],
       [8, 9]])
&gt;&gt;&gt; list(y)
[0, 1, 2, 3, 4]

&gt;&gt;&gt; X_train, X_test, y_train, y_test = train_test_split(
...     X, y, test_size=0.33, random_state=42)
...
&gt;&gt;&gt; X_train
array([[4, 5],
       [0, 1],
       [6, 7]])
&gt;&gt;&gt; y_train
[2, 0, 3]
&gt;&gt;&gt; X_test
array([[2, 3],
       [8, 9]])
&gt;&gt;&gt; y_test
[1, 4]

&gt;&gt;&gt; train_test_split(y, shuffle=False)
[[0, 1, 2], [3, 4]]
[0;31mFile:[0m      /Applications/anaconda3/lib/python3.7/site-packages/sklearn/model_selection/_split.py
[0;31mType:[0m      function</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=<span class="number">0.2</span>)</span><br><span class="line">print(X_train.shape)</span><br><span class="line">print(y_train.shape)</span><br><span class="line">print(X_test.shape)</span><br><span class="line">print(y_test.shape)</span><br></pre></td></tr></table></figure>

<pre><code>(1437, 64)
(1437,)
(360, 64)
(360,)</code></pre><h1 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">KNNClf = KNeighborsClassifier(n_neighbors=<span class="number">3</span>)</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">KNNClf.fit(X_train, y_train)</span><br></pre></td></tr></table></figure>




<pre><code>KNeighborsClassifier(algorithm=&apos;auto&apos;, leaf_size=30, metric=&apos;minkowski&apos;,
                     metric_params=None, n_jobs=None, n_neighbors=3, p=2,
                     weights=&apos;uniform&apos;)</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">res = KNNClf.predict(X_test)</span><br><span class="line">res</span><br></pre></td></tr></table></figure>




<pre><code>array([3, 4, 8, 5, 5, 7, 0, 3, 1, 4, 7, 5, 5, 8, 0, 7, 4, 7, 1, 7, 9, 4,
       4, 7, 6, 1, 2, 9, 1, 3, 3, 3, 7, 0, 7, 0, 2, 8, 9, 1, 1, 5, 4, 8,
       9, 0, 4, 9, 4, 9, 7, 2, 7, 3, 3, 4, 1, 9, 9, 9, 0, 4, 0, 6, 1, 0,
       0, 3, 6, 2, 3, 2, 8, 5, 9, 3, 1, 1, 6, 9, 8, 1, 2, 3, 2, 6, 8, 8,
       4, 6, 8, 6, 3, 9, 2, 8, 3, 6, 5, 7, 1, 7, 3, 8, 8, 8, 0, 0, 9, 1,
       9, 8, 5, 1, 1, 0, 1, 6, 5, 1, 7, 6, 5, 7, 7, 2, 2, 7, 3, 1, 9, 5,
       9, 5, 5, 3, 8, 4, 9, 5, 4, 6, 0, 5, 4, 8, 6, 1, 2, 8, 0, 9, 0, 9,
       7, 9, 7, 0, 2, 8, 2, 4, 0, 6, 2, 6, 7, 5, 6, 3, 8, 8, 0, 3, 2, 0,
       6, 1, 0, 6, 0, 5, 9, 3, 3, 0, 4, 0, 4, 2, 4, 9, 0, 6, 7, 4, 6, 5,
       9, 7, 2, 2, 3, 3, 0, 3, 9, 4, 9, 8, 5, 6, 9, 0, 1, 3, 5, 0, 5, 1,
       6, 4, 6, 6, 6, 7, 9, 1, 0, 7, 6, 6, 7, 8, 0, 3, 8, 5, 6, 8, 1, 3,
       0, 3, 6, 0, 3, 5, 6, 7, 0, 6, 9, 7, 0, 0, 2, 1, 6, 6, 9, 1, 6, 9,
       8, 7, 0, 2, 5, 1, 8, 6, 4, 3, 8, 2, 9, 2, 8, 4, 6, 4, 8, 9, 3, 1,
       1, 5, 0, 7, 8, 2, 3, 8, 4, 7, 7, 7, 7, 9, 4, 1, 7, 0, 2, 9, 1, 8,
       2, 4, 1, 0, 7, 5, 6, 0, 7, 1, 1, 5, 7, 1, 1, 6, 5, 6, 2, 2, 3, 9,
       7, 5, 3, 1, 5, 9, 9, 2, 5, 1, 6, 8, 2, 2, 4, 2, 1, 0, 6, 1, 2, 9,
       7, 5, 3, 5, 6, 1, 8, 1])</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">y_test</span><br></pre></td></tr></table></figure>




<pre><code>array([3, 4, 8, 5, 5, 7, 0, 3, 1, 4, 7, 5, 5, 8, 0, 7, 4, 7, 1, 7, 9, 4,
       4, 7, 6, 1, 2, 9, 1, 3, 3, 3, 7, 0, 7, 0, 2, 8, 9, 1, 1, 5, 4, 8,
       9, 0, 4, 9, 4, 9, 7, 2, 7, 8, 3, 4, 1, 9, 9, 9, 0, 4, 0, 6, 1, 0,
       0, 3, 6, 2, 3, 2, 8, 5, 9, 3, 1, 1, 6, 9, 8, 1, 2, 3, 2, 6, 8, 8,
       4, 6, 8, 6, 3, 9, 2, 8, 3, 6, 5, 7, 1, 7, 9, 8, 8, 8, 0, 0, 9, 1,
       4, 8, 5, 1, 1, 0, 1, 6, 5, 1, 7, 6, 5, 7, 7, 2, 2, 7, 3, 1, 9, 5,
       9, 5, 5, 3, 8, 4, 9, 5, 4, 6, 0, 5, 4, 8, 6, 1, 2, 8, 0, 9, 0, 9,
       7, 9, 7, 0, 2, 8, 2, 4, 0, 6, 2, 6, 7, 5, 6, 3, 8, 8, 0, 3, 2, 0,
       6, 1, 0, 6, 0, 5, 9, 3, 3, 0, 4, 0, 4, 2, 4, 9, 0, 6, 7, 4, 6, 5,
       9, 7, 2, 2, 3, 3, 0, 3, 9, 4, 9, 8, 5, 6, 9, 0, 1, 3, 5, 0, 5, 1,
       6, 4, 6, 6, 6, 7, 9, 1, 0, 7, 6, 6, 7, 8, 0, 3, 8, 5, 6, 8, 1, 3,
       0, 3, 6, 0, 3, 5, 6, 7, 0, 6, 9, 7, 0, 0, 2, 1, 6, 6, 9, 1, 6, 9,
       8, 7, 0, 2, 5, 1, 8, 6, 4, 3, 8, 2, 9, 2, 8, 4, 6, 4, 8, 9, 3, 1,
       1, 5, 0, 7, 8, 2, 3, 8, 4, 7, 7, 7, 7, 7, 4, 1, 3, 0, 2, 9, 1, 8,
       2, 4, 1, 0, 7, 5, 6, 0, 7, 1, 1, 5, 7, 1, 1, 6, 5, 6, 2, 2, 3, 9,
       7, 5, 3, 1, 5, 9, 9, 2, 5, 1, 6, 8, 2, 2, 4, 2, 1, 0, 6, 1, 2, 9,
       7, 5, 3, 5, 6, 1, 8, 8])</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">num = sum(res == y_test)</span><br><span class="line">num</span><br></pre></td></tr></table></figure>




<pre><code>354</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">print(<span class="string">'accuracy '</span>, num / len(y_test))</span><br></pre></td></tr></table></figure>

<pre><code>accuracy  0.9833333333333333</code></pre><h4 id="ä½¿ç”¨sklearnä¸­å°è£…çš„è®¡ç®—ç²¾ç¡®åº¦çš„æ–¹æ³•"><a href="#ä½¿ç”¨sklearnä¸­å°è£…çš„è®¡ç®—ç²¾ç¡®åº¦çš„æ–¹æ³•" class="headerlink" title="ä½¿ç”¨sklearnä¸­å°è£…çš„è®¡ç®—ç²¾ç¡®åº¦çš„æ–¹æ³•"></a>ä½¿ç”¨sklearnä¸­å°è£…çš„è®¡ç®—ç²¾ç¡®åº¦çš„æ–¹æ³•</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> accuracy_score <span class="keyword">as</span> accuracy</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">accuracy(res, y_test)</span><br></pre></td></tr></table></figure>




<pre><code>0.9833333333333333</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="https://blog.edlison.com/dev/ml/KNN-%E9%B8%A2%E5%B0%BE%E8%8A%B1%E6%95%B0%E6%8D%AE%E9%9B%86/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Bolin Shen">
      <meta itemprop="description" content="Edlison blog">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Edlison is talking here.">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/dev/ml/KNN-%E9%B8%A2%E5%B0%BE%E8%8A%B1%E6%95%B0%E6%8D%AE%E9%9B%86/" class="post-title-link" itemprop="url">dev/ml/KNN-é¸¢å°¾èŠ±æ•°æ®é›†</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 05-17-2020 16:36:25 / Modified: 16:37:09" itemprop="dateCreated datePublished" datetime="2020-05-17T16:36:25+08:00">05-17-2020</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="KNN-é¸¢å°¾èŠ±æ•°æ®é›†"><a href="#KNN-é¸¢å°¾èŠ±æ•°æ®é›†" class="headerlink" title="KNN-é¸¢å°¾èŠ±æ•°æ®é›†"></a>KNN-é¸¢å°¾èŠ±æ•°æ®é›†</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> datasets</span><br></pre></td></tr></table></figure>

<h4 id="ä½¿ç”¨sklearnæœ¬åœ°æ•°æ®é›†ä¸­çš„é¸¢å°¾èŠ±æ•°æ®é›†"><a href="#ä½¿ç”¨sklearnæœ¬åœ°æ•°æ®é›†ä¸­çš„é¸¢å°¾èŠ±æ•°æ®é›†" class="headerlink" title="ä½¿ç”¨sklearnæœ¬åœ°æ•°æ®é›†ä¸­çš„é¸¢å°¾èŠ±æ•°æ®é›†"></a>ä½¿ç”¨sklearnæœ¬åœ°æ•°æ®é›†ä¸­çš„é¸¢å°¾èŠ±æ•°æ®é›†</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">iris = datasets.load_iris()</span><br><span class="line">iris.keys()</span><br></pre></td></tr></table></figure>




<pre><code>dict_keys([&apos;data&apos;, &apos;target&apos;, &apos;target_names&apos;, &apos;DESCR&apos;, &apos;feature_names&apos;, &apos;filename&apos;])</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">X = iris.data</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Y = iris.target</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">X.shape</span><br></pre></td></tr></table></figure>




<pre><code>(150, 4)</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Y.shape</span><br></pre></td></tr></table></figure>




<pre><code>(150,)</code></pre><h1 id="æ‰‹åŠ¨åˆ†ç¦»æµ‹è¯•æ•°æ®"><a href="#æ‰‹åŠ¨åˆ†ç¦»æµ‹è¯•æ•°æ®" class="headerlink" title="æ‰‹åŠ¨åˆ†ç¦»æµ‹è¯•æ•°æ®"></a>æ‰‹åŠ¨åˆ†ç¦»æµ‹è¯•æ•°æ®</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">shuffled_indexes = np.random.permutation(len(X))</span><br><span class="line">shuffled_indexes</span><br></pre></td></tr></table></figure>




<pre><code>array([ 47,  10, 144,  57, 135,  58,  36, 136,  73, 109,  64,  15, 104,
       143, 108,  83,  23, 126, 125, 131, 137,  22,  16,  29, 118,  31,
        33,  52,  32, 132,  45,  38,  78, 139,  30,  37,  61,  97, 122,
        56, 107,  66, 114,  87,  43,  76,  84,  79, 142,  70,  77,  42,
         7, 138, 141, 120, 129,  44,  24,  53, 116,  13,  91, 119,  93,
         6,  60,  50,  67,  20,  54,  71,  89,  68,  21, 133, 148,  81,
        25,  48, 130, 127,  28,  90,  82, 146, 100, 105,  80,  94,  14,
        55, 111, 106, 101, 103,  35,  99,   3,  26,  69, 124,  95,  96,
       140,  46,  19,  34,  75,  59,   1, 117, 121,  49, 110,   0, 115,
        72,   9,  18, 149,  40, 145,  92, 123,  51,   4,  11,  39,  85,
        62, 147, 102,  74,   2,  86,   8,  17,   5,  27, 112, 128,  12,
        65,  41, 134,  63,  88, 113,  98])</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">test_ratio = <span class="number">0.2</span></span><br><span class="line">test_size = int(len(X) * test_ratio)</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">test_indexes = shuffled_indexes[:test_size]</span><br><span class="line">train_indexes = shuffled_indexes[test_size:]</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">X_train = X[train_indexes]</span><br><span class="line">Y_train = Y[train_indexes]</span><br><span class="line"></span><br><span class="line">X_test = X[test_indexes]</span><br><span class="line">Y_test = Y[test_indexes]</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">print(X_train.shape);print(Y_train.shape);print(X_test.shape);print(Y_test.shape)</span><br></pre></td></tr></table></figure>

<pre><code>(120, 4)
(120,)
(30, 4)
(30,)</code></pre><h1 id="ä½¿ç”¨sklearnåˆ†ç¦»"><a href="#ä½¿ç”¨sklearnåˆ†ç¦»" class="headerlink" title="ä½¿ç”¨sklearnåˆ†ç¦»"></a>ä½¿ç”¨sklearnåˆ†ç¦»</h1><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</span><br><span class="line">train_test_split?</span><br></pre></td></tr></table></figure>


<pre><code>[0;31mSignature:[0m [0mtrain_test_split[0m[0;34m([0m[0;34m*[0m[0marrays[0m[0;34m,[0m [0;34m**[0m[0moptions[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[0;31mDocstring:[0m
Split arrays or matrices into random train and test subsets

Quick utility that wraps input validation and
``next(ShuffleSplit().split(X, y))`` and application to input data
into a single call for splitting (and optionally subsampling) data in a
oneliner.

Read more in the :ref:`User Guide &lt;cross_validation&gt;`.

Parameters
----------
*arrays : sequence of indexables with same length / shape[0]
    Allowed inputs are lists, numpy arrays, scipy-sparse
    matrices or pandas dataframes.

test_size : float, int or None, optional (default=None)
    If float, should be between 0.0 and 1.0 and represent the proportion
    of the dataset to include in the test split. If int, represents the
    absolute number of test samples. If None, the value is set to the
    complement of the train size. If ``train_size`` is also None, it will
    be set to 0.25.

train_size : float, int, or None, (default=None)
    If float, should be between 0.0 and 1.0 and represent the
    proportion of the dataset to include in the train split. If
    int, represents the absolute number of train samples. If None,
    the value is automatically set to the complement of the test size.

random_state : int, RandomState instance or None, optional (default=None)
    If int, random_state is the seed used by the random number generator;
    If RandomState instance, random_state is the random number generator;
    If None, the random number generator is the RandomState instance used
    by `np.random`.

shuffle : boolean, optional (default=True)
    Whether or not to shuffle the data before splitting. If shuffle=False
    then stratify must be None.

stratify : array-like or None (default=None)
    If not None, data is split in a stratified fashion, using this as
    the class labels.

Returns
-------
splitting : list, length=2 * len(arrays)
    List containing train-test split of inputs.

    .. versionadded:: 0.16
        If the input is sparse, the output will be a
        ``scipy.sparse.csr_matrix``. Else, output type is the same as the
        input type.

Examples
--------
&gt;&gt;&gt; import numpy as np
&gt;&gt;&gt; from sklearn.model_selection import train_test_split
&gt;&gt;&gt; X, y = np.arange(10).reshape((5, 2)), range(5)
&gt;&gt;&gt; X
array([[0, 1],
       [2, 3],
       [4, 5],
       [6, 7],
       [8, 9]])
&gt;&gt;&gt; list(y)
[0, 1, 2, 3, 4]

&gt;&gt;&gt; X_train, X_test, y_train, y_test = train_test_split(
...     X, y, test_size=0.33, random_state=42)
...
&gt;&gt;&gt; X_train
array([[4, 5],
       [0, 1],
       [6, 7]])
&gt;&gt;&gt; y_train
[2, 0, 3]
&gt;&gt;&gt; X_test
array([[2, 3],
       [8, 9]])
&gt;&gt;&gt; y_test
[1, 4]

&gt;&gt;&gt; train_test_split(y, shuffle=False)
[[0, 1, 2], [3, 4]]
[0;31mFile:[0m      /Applications/anaconda3/lib/python3.7/site-packages/sklearn/model_selection/_split.py
[0;31mType:[0m      function</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">X_train, X_test, Y_train, Y_test = train_test_split(X, Y, test_size=<span class="number">0.2</span>, random_state=<span class="number">1</span>)</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">print(X_train.shape)</span><br><span class="line">print(Y_train.shape)</span><br><span class="line">print(X_test.shape)</span><br><span class="line">print(Y_test.shape)</span><br></pre></td></tr></table></figure>

<pre><code>(120, 4)
(120,)
(30, 4)
(30,)</code></pre><h1 id="ä½¿ç”¨sklearnä¸­çš„KNNåˆ†ç¦»å™¨æµ‹è¯•"><a href="#ä½¿ç”¨sklearnä¸­çš„KNNåˆ†ç¦»å™¨æµ‹è¯•" class="headerlink" title="ä½¿ç”¨sklearnä¸­çš„KNNåˆ†ç¦»å™¨æµ‹è¯•"></a>ä½¿ç”¨sklearnä¸­çš„KNNåˆ†ç¦»å™¨æµ‹è¯•</h1><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.neighbors <span class="keyword">import</span> KNeighborsClassifier</span><br><span class="line">KNeighborsClassifier?</span><br></pre></td></tr></table></figure>


<pre><code>[0;31mInit signature:[0m
[0mKNeighborsClassifier[0m[0;34m([0m[0;34m[0m
[0;34m[0m    [0mn_neighbors[0m[0;34m=[0m[0;36m5[0m[0;34m,[0m[0;34m[0m
[0;34m[0m    [0mweights[0m[0;34m=[0m[0;34m&apos;uniform&apos;[0m[0;34m,[0m[0;34m[0m
[0;34m[0m    [0malgorithm[0m[0;34m=[0m[0;34m&apos;auto&apos;[0m[0;34m,[0m[0;34m[0m
[0;34m[0m    [0mleaf_size[0m[0;34m=[0m[0;36m30[0m[0;34m,[0m[0;34m[0m
[0;34m[0m    [0mp[0m[0;34m=[0m[0;36m2[0m[0;34m,[0m[0;34m[0m
[0;34m[0m    [0mmetric[0m[0;34m=[0m[0;34m&apos;minkowski&apos;[0m[0;34m,[0m[0;34m[0m
[0;34m[0m    [0mmetric_params[0m[0;34m=[0m[0;32mNone[0m[0;34m,[0m[0;34m[0m
[0;34m[0m    [0mn_jobs[0m[0;34m=[0m[0;32mNone[0m[0;34m,[0m[0;34m[0m
[0;34m[0m    [0;34m**[0m[0mkwargs[0m[0;34m,[0m[0;34m[0m
[0;34m[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[0;31mDocstring:[0m     
Classifier implementing the k-nearest neighbors vote.

Read more in the :ref:`User Guide &lt;classification&gt;`.

Parameters
----------
n_neighbors : int, optional (default = 5)
    Number of neighbors to use by default for :meth:`kneighbors` queries.

weights : str or callable, optional (default = &apos;uniform&apos;)
    weight function used in prediction.  Possible values:

    - &apos;uniform&apos; : uniform weights.  All points in each neighborhood
      are weighted equally.
    - &apos;distance&apos; : weight points by the inverse of their distance.
      in this case, closer neighbors of a query point will have a
      greater influence than neighbors which are further away.
    - [callable] : a user-defined function which accepts an
      array of distances, and returns an array of the same shape
      containing the weights.

algorithm : {&apos;auto&apos;, &apos;ball_tree&apos;, &apos;kd_tree&apos;, &apos;brute&apos;}, optional
    Algorithm used to compute the nearest neighbors:

    - &apos;ball_tree&apos; will use :class:`BallTree`
    - &apos;kd_tree&apos; will use :class:`KDTree`
    - &apos;brute&apos; will use a brute-force search.
    - &apos;auto&apos; will attempt to decide the most appropriate algorithm
      based on the values passed to :meth:`fit` method.

    Note: fitting on sparse input will override the setting of
    this parameter, using brute force.

leaf_size : int, optional (default = 30)
    Leaf size passed to BallTree or KDTree.  This can affect the
    speed of the construction and query, as well as the memory
    required to store the tree.  The optimal value depends on the
    nature of the problem.

p : integer, optional (default = 2)
    Power parameter for the Minkowski metric. When p = 1, this is
    equivalent to using manhattan_distance (l1), and euclidean_distance
    (l2) for p = 2. For arbitrary p, minkowski_distance (l_p) is used.

metric : string or callable, default &apos;minkowski&apos;
    the distance metric to use for the tree.  The default metric is
    minkowski, and with p=2 is equivalent to the standard Euclidean
    metric. See the documentation of the DistanceMetric class for a
    list of available metrics.
    If metric is &quot;precomputed&quot;, X is assumed to be a distance matrix and
    must be square during fit. X may be a :term:`Glossary &lt;sparse graph&gt;`,
    in which case only &quot;nonzero&quot; elements may be considered neighbors.

metric_params : dict, optional (default = None)
    Additional keyword arguments for the metric function.

n_jobs : int or None, optional (default=None)
    The number of parallel jobs to run for neighbors search.
    ``None`` means 1 unless in a :obj:`joblib.parallel_backend` context.
    ``-1`` means using all processors. See :term:`Glossary &lt;n_jobs&gt;`
    for more details.
    Doesn&apos;t affect :meth:`fit` method.

Attributes
----------
classes_ : array of shape (n_classes,)
    Class labels known to the classifier

effective_metric_ : string or callble
    The distance metric used. It will be same as the `metric` parameter
    or a synonym of it, e.g. &apos;euclidean&apos; if the `metric` parameter set to
    &apos;minkowski&apos; and `p` parameter set to 2.

effective_metric_params_ : dict
    Additional keyword arguments for the metric function. For most metrics
    will be same with `metric_params` parameter, but may also contain the
    `p` parameter value if the `effective_metric_` attribute is set to
    &apos;minkowski&apos;.

outputs_2d_ : bool
    False when `y`&apos;s shape is (n_samples, ) or (n_samples, 1) during fit
    otherwise True.

Examples
--------
&gt;&gt;&gt; X = [[0], [1], [2], [3]]
&gt;&gt;&gt; y = [0, 0, 1, 1]
&gt;&gt;&gt; from sklearn.neighbors import KNeighborsClassifier
&gt;&gt;&gt; neigh = KNeighborsClassifier(n_neighbors=3)
&gt;&gt;&gt; neigh.fit(X, y)
KNeighborsClassifier(...)
&gt;&gt;&gt; print(neigh.predict([[1.1]]))
[0]
&gt;&gt;&gt; print(neigh.predict_proba([[0.9]]))
[[0.66666667 0.33333333]]

See also
--------
RadiusNeighborsClassifier
KNeighborsRegressor
RadiusNeighborsRegressor
NearestNeighbors

Notes
-----
See :ref:`Nearest Neighbors &lt;neighbors&gt;` in the online documentation
for a discussion of the choice of ``algorithm`` and ``leaf_size``.

.. warning::

   Regarding the Nearest Neighbors algorithms, if it is found that two
   neighbors, neighbor `k+1` and `k`, have identical distances
   but different labels, the results will depend on the ordering of the
   training data.

https://en.wikipedia.org/wiki/K-nearest_neighbor_algorithm
[0;31mFile:[0m           /Applications/anaconda3/lib/python3.7/site-packages/sklearn/neighbors/_classification.py
[0;31mType:[0m           ABCMeta
[0;31mSubclasses:[0m     </code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">KNNClf = KNeighborsClassifier(n_neighbors=<span class="number">3</span>)</span><br><span class="line">KNNClf.fit(X_train, Y_train)</span><br></pre></td></tr></table></figure>




<pre><code>KNeighborsClassifier(algorithm=&apos;auto&apos;, leaf_size=30, metric=&apos;minkowski&apos;,
                     metric_params=None, n_jobs=None, n_neighbors=3, p=2,
                     weights=&apos;uniform&apos;)</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">res = KNNClf.predict(X_test)</span><br><span class="line">res</span><br></pre></td></tr></table></figure>




<pre><code>array([0, 1, 1, 0, 2, 1, 2, 0, 0, 2, 1, 0, 2, 1, 1, 0, 1, 1, 0, 0, 1, 1,
       1, 0, 2, 1, 0, 0, 1, 2])</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Y_test</span><br></pre></td></tr></table></figure>




<pre><code>array([0, 1, 1, 0, 2, 1, 2, 0, 0, 2, 1, 0, 2, 1, 1, 0, 1, 1, 0, 0, 1, 1,
       1, 0, 2, 1, 0, 0, 1, 2])</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">acc = sum(res == Y_test)</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">print(<span class="string">'accuracy '</span>, acc / len(Y_test))</span><br></pre></td></tr></table></figure>

<pre><code>accuracy  1.0</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="https://blog.edlison.com/dev/ml/KNN-%E6%89%8B%E5%8A%A8%E5%AE%9E%E7%8E%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Bolin Shen">
      <meta itemprop="description" content="Edlison blog">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Edlison is talking here.">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/dev/ml/KNN-%E6%89%8B%E5%8A%A8%E5%AE%9E%E7%8E%B0/" class="post-title-link" itemprop="url">dev/ml/KNN-æ‰‹åŠ¨å®ç°</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 05-17-2020 16:34:34 / Modified: 16:36:05" itemprop="dateCreated datePublished" datetime="2020-05-17T16:34:34+08:00">05-17-2020</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="æ‰‹åŠ¨å®ç°KNN"><a href="#æ‰‹åŠ¨å®ç°KNN" class="headerlink" title="æ‰‹åŠ¨å®ç°KNN"></a>æ‰‹åŠ¨å®ç°KNN</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">raw_data_x = [[<span class="number">3.393533211</span>, <span class="number">2.331273381</span>],</span><br><span class="line">              [<span class="number">3.110073483</span>, <span class="number">1.781539638</span>],</span><br><span class="line">              [<span class="number">1.343808831</span>, <span class="number">3.368360954</span>],</span><br><span class="line">              [<span class="number">3.582294042</span>, <span class="number">4.679179110</span>],</span><br><span class="line">              [<span class="number">2.280362439</span>, <span class="number">2.866990263</span>],</span><br><span class="line">              [<span class="number">7.423436942</span>, <span class="number">4.696522875</span>],</span><br><span class="line">              [<span class="number">5.745051997</span>, <span class="number">3.533989803</span>],</span><br><span class="line">              [<span class="number">9.172168622</span>, <span class="number">2.511101045</span>],</span><br><span class="line">              [<span class="number">7.792783481</span>, <span class="number">3.424088941</span>],</span><br><span class="line">              [<span class="number">7.939820817</span>, <span class="number">0.791637231</span>]</span><br><span class="line">             ]</span><br><span class="line">raw_data_y = [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>]</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">x_train = np.array(raw_data_x)</span><br><span class="line">y_train = np.array(raw_data_y)</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">x_train</span><br></pre></td></tr></table></figure>




<pre><code>array([[3.39353321, 2.33127338],
       [3.11007348, 1.78153964],
       [1.34380883, 3.36836095],
       [3.58229404, 4.67917911],
       [2.28036244, 2.86699026],
       [7.42343694, 4.69652288],
       [5.745052  , 3.5339898 ],
       [9.17216862, 2.51110105],
       [7.79278348, 3.42408894],
       [7.93982082, 0.79163723]])</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">y_train==<span class="number">1</span></span><br></pre></td></tr></table></figure>




<pre><code>array([False, False, False, False, False,  True,  True,  True,  True,
        True])</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">plt.scatter(x_train[y_train==<span class="number">1</span>, <span class="number">0</span>], x_train[y_train==<span class="number">1</span>, <span class="number">1</span>], color=<span class="string">'r'</span>, label=<span class="string">'1'</span>)</span><br><span class="line">plt.scatter(x_train[y_train==<span class="number">0</span>, <span class="number">0</span>], x_train[y_train==<span class="number">0</span>, <span class="number">1</span>], color=<span class="string">'g'</span>, label=<span class="string">'0'</span>)</span><br><span class="line">plt.legend()</span><br></pre></td></tr></table></figure>




<pre><code>&lt;matplotlib.legend.Legend at 0x122311ad0&gt;</code></pre><p><img src="data/output_6_1.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">x = np.array([<span class="number">8.093607318</span>, <span class="number">3.365731514</span>])</span><br><span class="line"></span><br><span class="line">plt.scatter(x_train[y_train==<span class="number">1</span>, <span class="number">0</span>], x_train[y_train==<span class="number">1</span>, <span class="number">1</span>], color=<span class="string">'r'</span>, label=<span class="string">'1'</span>)</span><br><span class="line">plt.scatter(x_train[y_train==<span class="number">0</span>, <span class="number">0</span>], x_train[y_train==<span class="number">0</span>, <span class="number">1</span>], color=<span class="string">'g'</span>, label=<span class="string">'0'</span>)</span><br><span class="line">plt.scatter(x[<span class="number">0</span>], x[<span class="number">1</span>], color=<span class="string">'b'</span>)</span><br><span class="line">plt.legend()</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>


<p><img src="data/output_7_0.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> math</span><br><span class="line">distance = []</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> each <span class="keyword">in</span> x_train:</span><br><span class="line">    d = math.sqrt(np.sum((each - x) ** <span class="number">2</span>))</span><br><span class="line">    distance.append(d)</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">distance</span><br></pre></td></tr></table></figure>




<pre><code>[4.812566907609877,
 5.229270827235305,
 6.749798999160064,
 4.6986266144110695,
 5.83460014556857,
 1.4900114024329525,
 2.354574897431513,
 1.3761132675144652,
 0.3064319992975,
 2.5786840957478887]</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">distances = [math.sqrt(np.sum((each - x) ** <span class="number">2</span>)) <span class="keyword">for</span> each <span class="keyword">in</span> x_train]</span><br><span class="line">distances</span><br></pre></td></tr></table></figure>




<pre><code>[4.812566907609877,
 5.229270827235305,
 6.749798999160064,
 4.6986266144110695,
 5.83460014556857,
 1.4900114024329525,
 2.354574897431513,
 1.3761132675144652,
 0.3064319992975,
 2.5786840957478887]</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">nearest = np.argsort(distances)</span><br><span class="line">nearest</span><br></pre></td></tr></table></figure>




<pre><code>array([8, 7, 5, 6, 9, 3, 0, 1, 4, 2])</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">k = <span class="number">6</span></span><br><span class="line">topK_y = [y_train[i] <span class="keyword">for</span> i <span class="keyword">in</span> nearest[:k]]</span><br><span class="line">topK_y</span><br></pre></td></tr></table></figure>




<pre><code>[1, 1, 1, 1, 1, 0]</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> collections</span><br><span class="line">votes = collections.Counter(topK_y)</span><br><span class="line">votes</span><br></pre></td></tr></table></figure>




<pre><code>Counter({1: 5, 0: 1})</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">votes.most_common(<span class="number">1</span>)</span><br></pre></td></tr></table></figure>




<pre><code>[(1, 5)]</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">predict_y = votes.most_common(<span class="number">1</span>)[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line">predict_y</span><br></pre></td></tr></table></figure>




<pre><code>1</code></pre><h1 id="scikit-learnå®ç°KNN"><a href="#scikit-learnå®ç°KNN" class="headerlink" title="scikit-learnå®ç°KNN"></a>scikit-learnå®ç°KNN</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> sklearn.neighbors <span class="keyword">import</span> KNeighborsClassifier</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">raw_data_x = [[<span class="number">3.393533211</span>, <span class="number">2.331273381</span>],</span><br><span class="line">              [<span class="number">3.110073483</span>, <span class="number">1.781539638</span>],</span><br><span class="line">              [<span class="number">1.343808831</span>, <span class="number">3.368360954</span>],</span><br><span class="line">              [<span class="number">3.582294042</span>, <span class="number">4.679179110</span>],</span><br><span class="line">              [<span class="number">2.280362439</span>, <span class="number">2.866990263</span>],</span><br><span class="line">              [<span class="number">7.423436942</span>, <span class="number">4.696522875</span>],</span><br><span class="line">              [<span class="number">5.745051997</span>, <span class="number">3.533989803</span>],</span><br><span class="line">              [<span class="number">9.172168622</span>, <span class="number">2.511101045</span>],</span><br><span class="line">              [<span class="number">7.792783481</span>, <span class="number">3.424088941</span>],</span><br><span class="line">              [<span class="number">7.939820817</span>, <span class="number">0.791637231</span>]</span><br><span class="line">             ]</span><br><span class="line">raw_data_y = [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">x_train = np.array(raw_data_x)</span><br><span class="line">y_train = np.array(raw_data_y)</span><br><span class="line"></span><br><span class="line">target = np.array([<span class="number">8.093607318</span>, <span class="number">3.365731514</span>])</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">KNN_classifier = KNeighborsClassifier(n_neighbors=<span class="number">6</span>)</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">KNN_classifier.fit(x_train, y_train)</span><br></pre></td></tr></table></figure>




<pre><code>KNeighborsClassifier(algorithm=&apos;auto&apos;, leaf_size=30, metric=&apos;minkowski&apos;,
                     metric_params=None, n_jobs=None, n_neighbors=6, p=2,
                     weights=&apos;uniform&apos;)</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">target = x.reshape(<span class="number">1</span>, <span class="number">-1</span>)</span><br><span class="line">print(target)</span><br></pre></td></tr></table></figure>

<pre><code>[[8.09360732 3.36573151]]</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">KNN_classifier.predict(target)</span><br></pre></td></tr></table></figure>




<pre><code>array([1])</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">res = KNN_classifier.predict(target)</span><br><span class="line">res[<span class="number">0</span>]</span><br></pre></td></tr></table></figure>




<pre><code>1</code></pre>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="https://blog.edlison.com/dev/ml/Python-%E6%95%B0%E6%8D%AE%E6%8E%A2%E7%B4%A2%E4%B9%8B%E5%8F%AF%E8%A7%86%E5%8C%96%E5%88%86%E6%9E%90/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Bolin Shen">
      <meta itemprop="description" content="Edlison blog">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Edlison is talking here.">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/dev/ml/Python-%E6%95%B0%E6%8D%AE%E6%8E%A2%E7%B4%A2%E4%B9%8B%E5%8F%AF%E8%A7%86%E5%8C%96%E5%88%86%E6%9E%90/" class="post-title-link" itemprop="url">dev/ml/Python-æ•°æ®æ¢ç´¢ä¹‹å¯è§†åŒ–åˆ†æ</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 05-17-2020 16:28:04 / Modified: 16:33:14" itemprop="dateCreated datePublished" datetime="2020-05-17T16:28:04+08:00">05-17-2020</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="Python-æ•°æ®å¯è§†åŒ–åˆ†æ"><a href="#Python-æ•°æ®å¯è§†åŒ–åˆ†æ" class="headerlink" title="Python æ•°æ®å¯è§†åŒ–åˆ†æ"></a>Python æ•°æ®å¯è§†åŒ–åˆ†æ</h2><hr>
<h4 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h4><p>åœ¨æœºå™¨å­¦ä¹ é¢†åŸŸä¸­ï¼Œå¯è§†åŒ–æ˜¯ååˆ†é‡è¦çš„ã€‚åœ¨å¼€å§‹ä¸€é¡¹æ–°ä»»åŠ¡æ—¶ï¼Œé€šè¿‡å¯è§†åŒ–æ‰‹æ®µæ¢ç´¢æ•°æ®èƒ½æ›´å¥½åœ°å¸®åŠ©äººä»¬æŠŠæ¡æ•°æ®çš„è¦ç‚¹ã€‚åœ¨åˆ†ææ¨¡å‹è¡¨ç°å’Œæ¨¡å‹æŠ¥å‘Šçš„ç»“æœæ—¶ï¼Œå¯è§†åŒ–èƒ½ä½¿åˆ†ææ˜¾å¾—æ›´åŠ ç”ŸåŠ¨é²œæ˜ã€‚æœ‰æ—¶å€™ï¼Œä¸ºäº†ç†è§£å¤æ‚çš„æ¨¡å‹ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥å°†é«˜ç»´ç©ºé—´æ˜ å°„ä¸ºè§†è§‰ä¸Šæ›´ç›´è§‚çš„äºŒç»´æˆ–ä¸‰ç»´å›¾å½¢ã€‚</p>
<p>æ€»è€Œè¨€ä¹‹ï¼Œå¯è§†åŒ–æ˜¯ä¸€ä¸ªç›¸å¯¹å¿«æ·çš„ä»æ•°æ®ä¸­æŒ–æ˜ä¿¡æ¯çš„æ‰‹æ®µã€‚æœ¬æ–‡å°†ä½¿ç”¨ Pandasã€Matplotlibã€seaborn ç­‰æµè¡Œçš„åº“ï¼Œå¸¦ä½ ä¸Šæ‰‹å¯è§†åŒ–ã€‚</p>
<h4 id="çŸ¥è¯†ç‚¹"><a href="#çŸ¥è¯†ç‚¹" class="headerlink" title="çŸ¥è¯†ç‚¹"></a>çŸ¥è¯†ç‚¹</h4><ul>
<li>å•å˜é‡å¯è§†åŒ–çš„å¸¸ç”¨æ–¹æ³•</li>
<li>å¤šå˜é‡å¯è§†åŒ–çš„å¸¸ç”¨æ–¹æ³•</li>
<li>t-SNE</li>
</ul>
<h3 id="æ•°æ®é›†"><a href="#æ•°æ®é›†" class="headerlink" title="æ•°æ®é›†"></a>æ•°æ®é›†</h3><p>é¦–å…ˆä½¿ç”¨ <code>import</code> è½½å…¥ç›¸å…³ä¾èµ–ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</span><br><span class="line">sns.set()</span><br></pre></td></tr></table></figure>

<p>åœ¨ç¬¬ä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯æŸç”µä¿¡è¿è¥å•†çš„å®¢æˆ·ç¦»ç½‘æ•°æ®é›†ï¼Œæœ¬æ¬¡å®éªŒä»æ—§ä½¿ç”¨è¿™ä¸ªæ•°æ®é›†ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df = pd.read_csv(<span class="string">'./data/telecom_churn.csv'</span>)</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.head()</span><br></pre></td></tr></table></figure>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}</code></pre><p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>State</th>
      <th>Account length</th>
      <th>Area code</th>
      <th>International plan</th>
      <th>Voice mail plan</th>
      <th>Number vmail messages</th>
      <th>Total day minutes</th>
      <th>Total day calls</th>
      <th>Total day charge</th>
      <th>Total eve minutes</th>
      <th>Total eve calls</th>
      <th>Total eve charge</th>
      <th>Total night minutes</th>
      <th>Total night calls</th>
      <th>Total night charge</th>
      <th>Total intl minutes</th>
      <th>Total intl calls</th>
      <th>Total intl charge</th>
      <th>Customer service calls</th>
      <th>Churn</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>KS</td>
      <td>128</td>
      <td>415</td>
      <td>No</td>
      <td>Yes</td>
      <td>25</td>
      <td>265.1</td>
      <td>110</td>
      <td>45.07</td>
      <td>197.4</td>
      <td>99</td>
      <td>16.78</td>
      <td>244.7</td>
      <td>91</td>
      <td>11.01</td>
      <td>10.0</td>
      <td>3</td>
      <td>2.70</td>
      <td>1</td>
      <td>False</td>
    </tr>
    <tr>
      <th>1</th>
      <td>OH</td>
      <td>107</td>
      <td>415</td>
      <td>No</td>
      <td>Yes</td>
      <td>26</td>
      <td>161.6</td>
      <td>123</td>
      <td>27.47</td>
      <td>195.5</td>
      <td>103</td>
      <td>16.62</td>
      <td>254.4</td>
      <td>103</td>
      <td>11.45</td>
      <td>13.7</td>
      <td>3</td>
      <td>3.70</td>
      <td>1</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NJ</td>
      <td>137</td>
      <td>415</td>
      <td>No</td>
      <td>No</td>
      <td>0</td>
      <td>243.4</td>
      <td>114</td>
      <td>41.38</td>
      <td>121.2</td>
      <td>110</td>
      <td>10.30</td>
      <td>162.6</td>
      <td>104</td>
      <td>7.32</td>
      <td>12.2</td>
      <td>5</td>
      <td>3.29</td>
      <td>0</td>
      <td>False</td>
    </tr>
    <tr>
      <th>3</th>
      <td>OH</td>
      <td>84</td>
      <td>408</td>
      <td>Yes</td>
      <td>No</td>
      <td>0</td>
      <td>299.4</td>
      <td>71</td>
      <td>50.90</td>
      <td>61.9</td>
      <td>88</td>
      <td>5.26</td>
      <td>196.9</td>
      <td>89</td>
      <td>8.86</td>
      <td>6.6</td>
      <td>7</td>
      <td>1.78</td>
      <td>2</td>
      <td>False</td>
    </tr>
    <tr>
      <th>4</th>
      <td>OK</td>
      <td>75</td>
      <td>415</td>
      <td>Yes</td>
      <td>No</td>
      <td>0</td>
      <td>166.7</td>
      <td>113</td>
      <td>28.34</td>
      <td>148.3</td>
      <td>122</td>
      <td>12.61</td>
      <td>186.9</td>
      <td>121</td>
      <td>8.41</td>
      <td>10.1</td>
      <td>3</td>
      <td>2.73</td>
      <td>3</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
</div>



<p>æœ€åä¸€ä¸ªæ•°æ®åˆ— Churn ç¦»ç½‘ç‡ æ˜¯æˆ‘ä»¬çš„ç›®æ ‡ç‰¹å¾ï¼Œå®ƒæ˜¯å¸ƒå°”å˜é‡ï¼Œå…¶ä¸­ True è¡¨ç¤ºå…¬å¸æœ€ç»ˆä¸¢å¤±äº†æ­¤å®¢æˆ·ï¼ŒFalse è¡¨ç¤ºå®¢æˆ·è¢«ä¿ç•™ã€‚ç¨åï¼Œå°†æ„å»ºåŸºäºå…¶ä»–ç‰¹å¾é¢„æµ‹ Churn ç‰¹å¾çš„æ¨¡å‹ã€‚ </p>
<h3 id="å•å˜é‡å¯è§†åŒ–"><a href="#å•å˜é‡å¯è§†åŒ–" class="headerlink" title="å•å˜é‡å¯è§†åŒ–"></a>å•å˜é‡å¯è§†åŒ–</h3><p>å•å˜é‡ï¼ˆunivariateï¼‰åˆ†æä¸€æ¬¡åªå…³æ³¨ä¸€ä¸ªå˜é‡ã€‚å½“æˆ‘ä»¬ç‹¬ç«‹åœ°åˆ†æä¸€ä¸ªç‰¹å¾æ—¶ï¼Œé€šå¸¸æœ€å…³å¿ƒçš„æ˜¯è¯¥ç‰¹å¾å€¼çš„åˆ†å¸ƒæƒ…å†µã€‚ä¸‹é¢è€ƒè™‘ä¸åŒç»Ÿè®¡ç±»å‹çš„å˜é‡ï¼Œä»¥åŠç›¸åº”çš„å¯è§†åŒ–å·¥å…·ã€‚</p>
<h4 id="æ•°é‡ç‰¹å¾"><a href="#æ•°é‡ç‰¹å¾" class="headerlink" title="æ•°é‡ç‰¹å¾"></a>æ•°é‡ç‰¹å¾</h4><p>æ•°é‡ç‰¹å¾ï¼ˆquantitative featureï¼‰çš„å€¼ä¸ºæœ‰åºæ•°å€¼ã€‚è¿™äº›å€¼å¯èƒ½æ˜¯ç¦»æ•£çš„ï¼Œä¾‹å¦‚æ•´æ•°ï¼Œä¹Ÿå¯èƒ½æ˜¯è¿ç»­çš„ï¼Œä¾‹å¦‚å®æ•°ã€‚</p>
<h4 id="ç›´æ–¹å›¾å’Œå¯†åº¦å›¾"><a href="#ç›´æ–¹å›¾å’Œå¯†åº¦å›¾" class="headerlink" title="ç›´æ–¹å›¾å’Œå¯†åº¦å›¾"></a>ç›´æ–¹å›¾å’Œå¯†åº¦å›¾</h4><p>ç›´æ–¹å›¾ä¾ç…§ç›¸ç­‰çš„é—´éš”å°†å€¼åˆ†ç»„ä¸ºæŸ±ï¼Œå®ƒçš„å½¢çŠ¶å¯èƒ½åŒ…å«äº†æ•°æ®åˆ†å¸ƒçš„ä¸€äº›ä¿¡æ¯ï¼Œå¦‚é«˜æ–¯åˆ†å¸ƒã€æŒ‡æ•°åˆ†å¸ƒç­‰ã€‚å½“åˆ†å¸ƒæ€»ä½“å‘ˆç°è§„å¾‹æ€§ï¼Œä½†æœ‰ä¸ªåˆ«å¼‚å¸¸å€¼æ—¶ï¼Œä½ å¯ä»¥é€šè¿‡ç›´æ–¹å›¾è¾¨è®¤å‡ºæ¥ã€‚å½“ä½ ä½¿ç”¨çš„æœºå™¨å­¦ä¹ æ–¹æ³•é¢„è®¾äº†æŸä¸€ç‰¹å®šåˆ†å¸ƒç±»å‹ï¼ˆé€šå¸¸æ˜¯é«˜æ–¯åˆ†å¸ƒï¼‰æ—¶ï¼ŒçŸ¥é“ç‰¹å¾å€¼çš„åˆ†å¸ƒæ˜¯éå¸¸é‡è¦çš„ã€‚</p>
<p>æœ€ç®€å•çš„æŸ¥çœ‹æ•°å€¼å˜é‡åˆ†å¸ƒçš„æ–¹æ³•æ˜¯ä½¿ç”¨ DataFrame çš„ <a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.hist.html" target="_blank" rel="noopener"><i class="fa fa-external-link-square" aria-hidden="true"> <code>hist()</code></i></a> æ–¹æ³•ç»˜åˆ¶ç›´æ–¹å›¾ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">features = [<span class="string">'Total day minutes'</span>, <span class="string">'Total intl calls'</span>]</span><br><span class="line">df[features].hist(figsize = (<span class="number">10</span>, <span class="number">4</span>))</span><br></pre></td></tr></table></figure>




<pre><code>array([[&lt;matplotlib.axes._subplots.AxesSubplot object at 0x12e3076d0&gt;,
        &lt;matplotlib.axes._subplots.AxesSubplot object at 0x12f4cbe90&gt;]],
      dtype=object)</code></pre><p><img src="data/output_21_1.png" alt="png"></p>
<p>ä¸Šå›¾è¡¨æ˜ï¼Œå˜é‡ Total day minutes æ¯æ—¥é€šè¯æ—¶é•¿ å‘ˆé«˜æ–¯åˆ†å¸ƒï¼Œè€Œ Total intl calls æ€»å›½é™…å‘¼å«æ•° æ˜¾è‘—å³å€¾ï¼ˆå®ƒå³ä¾§çš„å°¾å·´æ›´é•¿ï¼‰ã€‚</p>
<p>å¯†åº¦å›¾ï¼ˆdensity plotsï¼‰ï¼Œä¹Ÿå«æ ¸å¯†åº¦å›¾ï¼ˆ <a href="https://en.wikipedia.org/wiki/Kernel_density_estimation" target="_blank" rel="noopener"><i class="fa fa-external-link-square" aria-hidden="true"> kernel density estimate</i></a>ï¼ŒKDEï¼‰æ˜¯ç†è§£æ•°å€¼å˜é‡åˆ†å¸ƒçš„å¦ä¸€ä¸ªæ–¹æ³•ã€‚å®ƒå¯ä»¥çœ‹æˆæ˜¯ç›´æ–¹å›¾å¹³æ»‘ï¼ˆ <a href="https://en.wikipedia.org/wiki/Kernel_smoother" target="_blank" rel="noopener"><i class="fa fa-external-link-square" aria-hidden="true"> smoothed</i></a> ï¼‰çš„ç‰ˆæœ¬ã€‚ç›¸æ¯”ç›´æ–¹å›¾ï¼Œå®ƒçš„ä¸»è¦ä¼˜åŠ¿æ˜¯ä¸ä¾èµ–äºæŸ±çš„å°ºå¯¸ï¼Œæ›´åŠ æ¸…æ™°ã€‚</p>
<p>è®©æˆ‘ä»¬ä¸ºä¸Šé¢ä¸¤ä¸ªå˜é‡åˆ›å»ºå¯†åº¦å›¾ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df[features].plot(kind=<span class="string">'density'</span>, subplots=<span class="literal">True</span>, layout=(<span class="number">1</span>,<span class="number">2</span>),</span><br><span class="line">                 sharex=<span class="literal">False</span>, figsize=(<span class="number">10</span>, <span class="number">4</span>), legend=<span class="literal">False</span>, title=features)</span><br></pre></td></tr></table></figure>




<pre><code>array([[&lt;matplotlib.axes._subplots.AxesSubplot object at 0x133bcc050&gt;,
        &lt;matplotlib.axes._subplots.AxesSubplot object at 0x1343f1ad0&gt;]],
      dtype=object)</code></pre><p><img src="data/output_25_1.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sns.distplot(df[<span class="string">'Total day calls'</span>])</span><br></pre></td></tr></table></figure>




<pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x12e4f8810&gt;</code></pre><p><img src="data/output_26_1.png" alt="png"></p>
<p>å½“ç„¶ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ seaborn çš„ <a href="https://seaborn.pydata.org/generated/seaborn.distplot.html" target="_blank" rel="noopener"><i class="fa fa-external-link-square" aria-hidden="true"> <code>distplot()</code></i></a> æ–¹æ³•è§‚æµ‹æ•°å€¼å˜é‡çš„åˆ†å¸ƒã€‚ä¾‹å¦‚ï¼ŒTotal day minutes æ¯æ—¥é€šè¯æ—¶é•¿ çš„åˆ†å¸ƒã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œè¯¥æ–¹æ³•å°†åŒæ—¶æ˜¾ç¤ºç›´æ–¹å›¾å’Œå¯†åº¦å›¾ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sns.distplot(df[<span class="string">'Total intl calls'</span>])</span><br></pre></td></tr></table></figure>




<pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x12e5134d0&gt;</code></pre><p><img src="data/output_28_1.png" alt="png"></p>
<p>ä¸Šå›¾ä¸­ç›´æ–¹å›¾çš„æŸ±å½¢é«˜åº¦å·²è¿›è¡Œå½’ä¸€åŒ–å¤„ç†ï¼Œè¡¨ç¤ºçš„æ˜¯å¯†åº¦è€Œä¸æ˜¯æ ·æœ¬æ•°ã€‚</p>
<h4 id="ç®±å‹å›¾"><a href="#ç®±å‹å›¾" class="headerlink" title="ç®±å‹å›¾"></a>ç®±å‹å›¾</h4><p>ç®±å½¢å›¾çš„ä¸»è¦ç»„æˆéƒ¨åˆ†æ˜¯ç®±å­ï¼ˆboxï¼‰ï¼Œé¡»ï¼ˆwhiskerï¼‰å’Œä¸€äº›å•ç‹¬çš„æ•°æ®ç‚¹ï¼ˆç¦»ç¾¤å€¼ï¼‰ï¼Œåˆ†åˆ«ç®€å•ä»‹ç»å¦‚ä¸‹ï¼š</p>
<ul>
<li>ç®±å­æ˜¾ç¤ºäº†åˆ†å¸ƒçš„å››åˆ†ä½è·ï¼Œå®ƒçš„é•¿åº¦ç”± $25th , ï¼ˆ\text{Q1ï¼Œä¸‹å››åˆ†ä½æ•°}ï¼‰$ å’Œ $75th , ï¼ˆ\text{Q3ï¼Œä¸Šå››åˆ†ä½æ•°}ï¼‰$ å†³å®šï¼Œç®±ä¸­çš„æ°´å¹³çº¿è¡¨ç¤ºä¸­ä½æ•°  ï¼ˆ$50%$ï¼‰ã€‚</li>
<li>é¡»æ˜¯ä»ç®±å­å¤„å»¶ä¼¸å‡ºæ¥çš„çº¿ï¼Œå®ƒä»¬è¡¨ç¤ºæ•°æ®ç‚¹çš„æ€»ä½“æ•£å¸ƒï¼Œå…·ä½“è€Œè¨€ï¼Œæ˜¯ä½äºåŒºé—´ $ï¼ˆ\text{Q1} - 1.5 \cdot \text{IQR}, \text{Q3} + 1.5 \cdot \text{IQR}ï¼‰$çš„æ•°æ®ç‚¹ï¼Œå…¶ä¸­ $\text{IQR} = \text{Q3} - \text{Q1}$ï¼Œä¹Ÿå°±æ˜¯å››åˆ†ä½è·ã€‚</li>
<li>ç¦»ç¾¤å€¼æ˜¯é¡»ä¹‹å¤–çš„æ•°æ®ç‚¹ï¼Œå®ƒä»¬ä½œä¸ºå•ç‹¬çš„æ•°æ®ç‚¹ï¼Œæ²¿ç€ä¸­è½´ç»˜åˆ¶ã€‚</li>
</ul>
<p>ä½¿ç”¨ seaborn çš„ <code>boxplot()</code> æ–¹æ³•ç»˜åˆ¶ç®±å½¢å›¾ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sns.boxplot(df[<span class="string">'Total intl calls'</span>])</span><br></pre></td></tr></table></figure>




<pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x12e6e1750&gt;</code></pre><p><img src="data/output_34_1.png" alt="png"></p>
<p>ä¸Šå›¾è¡¨æ˜ï¼Œåœ¨è¯¥æ•°æ®é›†ä¸­ï¼Œå¤§é‡çš„å›½é™…å‘¼å«æ˜¯ç›¸å½“å°‘è§çš„ã€‚</p>
<h4 id="æç´å½¢å›¾"><a href="#æç´å½¢å›¾" class="headerlink" title="æç´å½¢å›¾"></a>æç´å½¢å›¾</h4><p>æˆ‘ä»¬æœ€åè€ƒè™‘çš„åˆ†å¸ƒå›¾å½¢æ˜¯æç´å½¢å›¾ï¼ˆviolin plotï¼‰ã€‚æç´å½¢å›¾å’Œç®±å½¢å›¾çš„åŒºåˆ«æ˜¯ï¼Œæç´å½¢å›¾èšç„¦äºå¹³æ»‘åçš„æ•´ä½“åˆ†å¸ƒï¼Œè€Œç®±å½¢å›¾æ˜¾ç¤ºäº†å•ç‹¬æ ·æœ¬çš„ç‰¹å®šç»Ÿè®¡æ•°æ®ã€‚</p>
<p>ä½¿ç”¨ <code>violinplot()</code> æ–¹æ³•ç»˜åˆ¶æç´å½¢å›¾ã€‚ä¸‹å›¾å·¦ä¾§æ˜¯ç®±å½¢å›¾ï¼Œå³ä¾§æ˜¯æç´å½¢å›¾ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line">_, ax = plt.subplots(<span class="number">1</span>, <span class="number">2</span>, sharey=<span class="literal">True</span>, figsize=(<span class="number">10</span>, <span class="number">4</span>))</span><br><span class="line"></span><br><span class="line">sns.boxplot(df[<span class="string">'Total intl calls'</span>], ax=ax[<span class="number">0</span>])</span><br><span class="line">sns.violinplot(df[<span class="string">'Total intl calls'</span>], ax=ax[<span class="number">1</span>])</span><br></pre></td></tr></table></figure>




<pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x1380219d0&gt;</code></pre><p><img src="data/output_39_1.png" alt="png"></p>
<h4 id="æ•°æ®æè¿°"><a href="#æ•°æ®æè¿°" class="headerlink" title="æ•°æ®æè¿°"></a>æ•°æ®æè¿°</h4><p>é™¤å›¾å½¢å·¥å…·å¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ DataFrame çš„ <a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.describe.html" target="_blank" rel="noopener"><i class="fa fa-external-link-square" aria-hidden="true"> <code>describe()</code></i></a> æ–¹æ³•æ¥è·å–åˆ†å¸ƒçš„ç²¾ç¡®æ•°å€¼ç»Ÿè®¡ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[features].describe()</span><br></pre></td></tr></table></figure>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}</code></pre><p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Total day minutes</th>
      <th>Total intl calls</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>3333.000000</td>
      <td>3333.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>179.775098</td>
      <td>4.479448</td>
    </tr>
    <tr>
      <th>std</th>
      <td>54.467389</td>
      <td>2.461214</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>143.700000</td>
      <td>3.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>179.400000</td>
      <td>4.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>216.400000</td>
      <td>6.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>350.800000</td>
      <td>20.000000</td>
    </tr>
  </tbody>
</table>
</div>



<p><code>describe()</code> çš„è¾“å‡ºåŸºæœ¬ä¸Šæ˜¯è‡ªè§£é‡Šæ€§çš„ï¼Œ25%ï¼Œ50% å’Œ 75% æ˜¯ç›¸åº”çš„ç™¾åˆ†æ•° <a href="https://en.wikipedia.org/wiki/Percentile" target="_blank" rel="noopener"><i class="fa fa-external-link-square" aria-hidden="true"> percentiles</i></a>ã€‚</p>
<h4 id="ç±»åˆ«ç‰¹å¾å’ŒäºŒå…ƒç‰¹å¾"><a href="#ç±»åˆ«ç‰¹å¾å’ŒäºŒå…ƒç‰¹å¾" class="headerlink" title="ç±»åˆ«ç‰¹å¾å’ŒäºŒå…ƒç‰¹å¾"></a>ç±»åˆ«ç‰¹å¾å’ŒäºŒå…ƒç‰¹å¾</h4><p>ç±»åˆ«ç‰¹å¾ï¼ˆcategorical features takeï¼‰åæ˜ äº†æ ·æœ¬çš„æŸä¸ªå®šæ€§å±æ€§ï¼Œå®ƒå…·æœ‰å›ºå®šæ•°ç›®çš„å€¼ï¼Œæ¯ä¸ªå€¼å°†ä¸€ä¸ªè§‚æµ‹æ•°æ®åˆ†é…åˆ°ç›¸åº”çš„ç»„ï¼Œè¿™äº›ç»„ç§°ä¸ºç±»åˆ«ï¼ˆcategoryï¼‰ã€‚å¦‚æœç±»åˆ«å˜é‡çš„å€¼å…·æœ‰é¡ºåºï¼Œç§°ä¸ºæœ‰åºï¼ˆordinalï¼‰ç±»åˆ«å˜é‡ã€‚</p>
<p>äºŒå…ƒï¼ˆbinaryï¼‰ç‰¹å¾æ˜¯ç±»åˆ«ç‰¹å¾çš„ç‰¹ä¾‹ï¼Œå…¶å¯èƒ½å€¼æœ‰ 2 ä¸ªã€‚</p>
<h4 id="é¢‘ç‡è¡¨"><a href="#é¢‘ç‡è¡¨" class="headerlink" title="é¢‘ç‡è¡¨"></a>é¢‘ç‡è¡¨</h4><p>è®©æˆ‘ä»¬æŸ¥çœ‹ä¸€ä¸‹ç›®æ ‡å˜é‡ Churn ç¦»ç½‘ç‡ çš„åˆ†å¸ƒæƒ…å†µã€‚é¦–å…ˆï¼Œä½¿ç”¨ <a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.Series.value_counts.html" target="_blank" rel="noopener"><i class="fa fa-external-link-square" aria-hidden="true"> <code>value_counts()</code></i></a> æ–¹æ³•å¾—åˆ°ä¸€å¼ é¢‘ç‡è¡¨ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[<span class="string">'Churn'</span>].value_counts()</span><br></pre></td></tr></table></figure>




<pre><code>False    2850
True      483
Name: Churn, dtype: int64</code></pre><p>ä¸Šè¡¨æ˜¾ç¤ºï¼Œè¯¥æ•°æ®é›†çš„ Churn æœ‰ 2850 ä¸ªå±äº Falseï¼ˆChurn==0ï¼‰ï¼Œæœ‰ 483 ä¸ªå±äº Trueï¼ˆChurn==1ï¼‰ï¼Œæ•°æ®é›†ä¸­å¿ å®å®¢æˆ·ï¼ˆChurn==0ï¼‰å’Œä¸å¿ å®å®¢æˆ·ï¼ˆChurn==1ï¼‰çš„æ¯”ä¾‹å¹¶ä¸ç›¸ç­‰ã€‚æˆ‘ä»¬å°†åœ¨ä»¥åçš„æ–‡ç« ä¸­çœ‹åˆ°ï¼Œè¿™ç§æ•°æ®ä¸å¹³è¡¡çš„æƒ…å†µä¼šå¯¼è‡´å»ºç«‹çš„åˆ†ç±»æ¨¡å‹å­˜åœ¨ä¸€å®šçš„é—®é¢˜ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ„å»ºåˆ†ç±»æ¨¡å‹å¯èƒ½éœ€è¦åŠ é‡å¯¹ã€Œå°‘æ•°æ•°æ®ï¼ˆåœ¨è¿™é‡Œæ˜¯ Churn==1ï¼‰åˆ†ç±»é”™è¯¯ã€è¿™ä¸€æƒ…å†µçš„æƒ©ç½šã€‚</p>
<h4 id="æ¡å½¢å›¾"><a href="#æ¡å½¢å›¾" class="headerlink" title="æ¡å½¢å›¾"></a>æ¡å½¢å›¾</h4><p>é¢‘ç‡è¡¨çš„å›¾å½¢åŒ–è¡¨ç¤ºæ˜¯æ¡å½¢å›¾ã€‚åˆ›å»ºæ¡å½¢å›¾æœ€ç®€å•çš„æ–¹æ³•æ˜¯ä½¿ç”¨ seaborn çš„ <a href="https://seaborn.pydata.org/generated/seaborn.countplot.html" target="_blank" rel="noopener"><i class="fa fa-external-link-square" aria-hidden="true"> <code>countplot()</code></i></a> å‡½æ•°ã€‚è®©æˆ‘ä»¬æ¥ç”»å‡ºä¸¤ä¸ªåˆ†ç±»å˜é‡çš„åˆ†å¸ƒã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">fig, ax = plt.subplots(<span class="number">1</span>, <span class="number">2</span>, figsize=[<span class="number">10</span>, <span class="number">4</span>])</span><br><span class="line"></span><br><span class="line">sns.countplot(df[<span class="string">'Churn'</span>], ax=ax[<span class="number">0</span>])</span><br><span class="line">sns.countplot(df[<span class="string">'Customer service calls'</span>], ax=ax[<span class="number">1</span>])</span><br></pre></td></tr></table></figure>




<pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x1382242d0&gt;</code></pre><p><img src="data/output_53_1.png" alt="png"></p>
<p>æ¡å½¢å›¾å’Œç›´æ–¹å›¾çš„åŒºåˆ«å¦‚ä¸‹ï¼š</p>
<ul>
<li>ç›´æ–¹å›¾é€‚åˆæŸ¥çœ‹æ•°å€¼å˜é‡çš„åˆ†å¸ƒï¼Œè€Œæ¡å½¢å›¾ç”¨äºæŸ¥çœ‹ç±»åˆ«ç‰¹å¾ã€‚</li>
<li>ç›´æ–¹å›¾çš„ X è½´æ˜¯æ•°å€¼ï¼›æ¡å½¢å›¾çš„ X è½´å¯èƒ½æ˜¯ä»»ä½•ç±»å‹ï¼Œå¦‚æ•°å­—ã€å­—ç¬¦ä¸²ã€å¸ƒå°”å€¼ã€‚</li>
<li>ç›´æ–¹å›¾çš„ X è½´æ˜¯ä¸€ä¸ªç¬›å¡å°”åæ ‡è½´ï¼›æ¡å½¢å›¾çš„é¡ºåºåˆ™æ²¡æœ‰äº‹å…ˆå®šä¹‰ã€‚</li>
</ul>
<p>ä¸Šå·¦å›¾æ¸…æ™°åœ°è¡¨æ˜äº†ç›®æ ‡å˜é‡çš„å¤±è¡¡æ€§ã€‚ä¸Šå³å›¾åˆ™è¡¨æ˜å¤§éƒ¨åˆ†å®¢æˆ·æœ€å¤šæ‰“äº† 2-3 ä¸ªå®¢æœç”µè¯å°±è§£å†³äº†ä»–ä»¬çš„é—®é¢˜ã€‚ä¸è¿‡ï¼Œæ—¢ç„¶æƒ³è¦é¢„æµ‹å°‘æ•°æ•°æ®çš„åˆ†ç±»ï¼ˆChurn==1ï¼‰ï¼Œæˆ‘ä»¬å¯èƒ½å¯¹å°‘æ•°ä¸æ»¡æ„çš„å®¢æˆ·çš„è¡¨ç°æ›´æ„Ÿå…´è¶£ã€‚æ‰€ä»¥è®©æˆ‘ä»¬å°è¯•ä¸€ä¸‹æ›´æœ‰è¶£çš„å¯è§†åŒ–æ–¹æ³•ï¼šå¤šå˜é‡å¯è§†åŒ–ï¼Œçœ‹èƒ½å¦å¯¹é¢„æµ‹æœ‰æ‰€å¸®åŠ©ã€‚</p>
<h3 id="å¤šå˜é‡å¯è§†åŒ–"><a href="#å¤šå˜é‡å¯è§†åŒ–" class="headerlink" title="å¤šå˜é‡å¯è§†åŒ–"></a>å¤šå˜é‡å¯è§†åŒ–</h3><p>å¤šå˜é‡ï¼ˆmultivariateï¼‰å›¾å½¢å¯ä»¥åœ¨å•å¼ å›¾åƒä¸­æŸ¥çœ‹ä¸¤ä¸ªä»¥ä¸Šå˜é‡çš„è”ç³»ï¼Œå’Œå•å˜é‡å›¾å½¢ä¸€æ ·ï¼Œå¯è§†åŒ–çš„ç±»å‹å–å†³äºå°†è¦åˆ†æçš„å˜é‡çš„ç±»å‹ã€‚</p>
<p>å…ˆæ¥çœ‹çœ‹æ•°é‡å˜é‡ä¹‹é—´çš„ç›¸äº’ä½œç”¨ã€‚</p>
<h4 id="ç›¸å…³çŸ©é˜µ"><a href="#ç›¸å…³çŸ©é˜µ" class="headerlink" title="ç›¸å…³çŸ©é˜µ"></a>ç›¸å…³çŸ©é˜µ</h4><p>ç›¸å…³çŸ©é˜µå¯æ­ç¤ºæ•°æ®é›†ä¸­çš„æ•°å€¼å˜é‡çš„ç›¸å…³æ€§ã€‚è¿™ä¸€ä¿¡æ¯å¾ˆé‡è¦ï¼Œå› ä¸ºæœ‰ä¸€äº›æœºå™¨å­¦ä¹ ç®—æ³•ï¼ˆæ¯”å¦‚ï¼Œçº¿æ€§å›å½’å’Œé€»è¾‘å›å½’ï¼‰ä¸èƒ½å¾ˆå¥½åœ°å¤„ç†é«˜åº¦ç›¸å…³çš„è¾“å…¥å˜é‡ã€‚</p>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬ä½¿ç”¨ DataFrame çš„ <a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.corr.html" target="_blank" rel="noopener"><i class="fa fa-external-link-square" aria-hidden="true"> <code>corr()</code></i></a> æ–¹æ³•è®¡ç®—å‡ºæ¯å¯¹ç‰¹å¾é—´çš„ç›¸å…³æ€§ã€‚æ¥ç€ï¼Œæˆ‘ä»¬å°†æ‰€å¾—çš„ç›¸å…³çŸ©é˜µï¼ˆcorrelation matrixï¼‰ä¼ ç»™ seaborn çš„ <a href="https://seaborn.pydata.org/generated/seaborn.heatmap.html" target="_blank" rel="noopener"><i class="fa fa-external-link-square" aria-hidden="true"> <code>heatmap()</code></i></a>æ–¹æ³•ï¼Œè¯¥æ–¹æ³•æ ¹æ®æä¾›çš„æ•°å€¼ï¼Œæ¸²æŸ“å‡ºä¸€ä¸ªåŸºäºè‰²å½©ç¼–ç çš„çŸ©é˜µã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">numerical = list(set(df.columns) - set([<span class="string">'State'</span>, <span class="string">'International plan'</span>, <span class="string">'Voice mail plan'</span>, <span class="string">'Area code'</span>, <span class="string">'Churn'</span>, <span class="string">'Customer service calls'</span>]))</span><br><span class="line"></span><br><span class="line">corr = df[numerical].corr()</span><br><span class="line">sns.heatmap(corr)</span><br></pre></td></tr></table></figure>




<pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x1388bad50&gt;</code></pre><p><img src="data/output_63_1.png" alt="png"></p>
<p>ä¸Šå›¾ä¸­ï¼ŒTotal day charge æ—¥è¯è´¹æ€»é¢ æ˜¯ç›´æ¥åŸºäº Total day minutes ç”µè¯çš„åˆ†é’Ÿæ•° è®¡ç®—å¾—åˆ°ï¼Œå®ƒè¢«ç§°ä¸ºå› å˜é‡ã€‚é™¤äº† Total day charege å¤–ï¼Œè¿˜æœ‰ 3 ä¸ªå› å˜é‡ï¼šTotal eve chargeï¼ŒTotal night chargeï¼ŒTotal intl chargeã€‚è¿™ 4 ä¸ªå› å˜é‡å¹¶ä¸è´¡çŒ®ä»»ä½•é¢å¤–ä¿¡æ¯ï¼Œæˆ‘ä»¬ç›´æ¥å»é™¤ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">numerical = list(set(numerical) - set([<span class="string">'Total day charge'</span>, <span class="string">'Total eve charge'</span>, <span class="string">'Total night charge'</span>, <span class="string">'Total intl charge'</span>]))</span><br><span class="line"></span><br><span class="line">corr = df[numerical].corr()</span><br><span class="line">sns.heatmap(corr)</span><br></pre></td></tr></table></figure>




<pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x1396822d0&gt;</code></pre><p><img src="data/output_65_1.png" alt="png"></p>
<h4 id="æ•£ç‚¹å›¾"><a href="#æ•£ç‚¹å›¾" class="headerlink" title="æ•£ç‚¹å›¾"></a>æ•£ç‚¹å›¾</h4><p>æ•£ç‚¹å›¾ï¼ˆscatter plotï¼‰å°†ä¸¤ä¸ªæ•°å€¼å˜é‡çš„å€¼æ˜¾ç¤ºä¸ºäºŒç»´ç©ºé—´ä¸­çš„ç¬›å¡å°”åæ ‡ï¼ˆCartesian coordinateï¼‰ã€‚é€šè¿‡ matplotlib åº“çš„ <a href="https://matplotlib.org/devdocs/api/_as_gen/matplotlib.pyplot.scatter.html" target="_blank" rel="noopener"><i class="fa fa-external-link-square" aria-hidden="true"> <code>scatter()</code></i></a> æ–¹æ³•å¯ä»¥ç»˜åˆ¶æ•£ç‚¹å›¾ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">plt.scatter(df[<span class="string">'Total day minutes'</span>], df[<span class="string">'Total night minutes'</span>])</span><br></pre></td></tr></table></figure>




<pre><code>&lt;matplotlib.collections.PathCollection at 0x139a17c10&gt;</code></pre><p><img src="data/output_67_1.png" alt="png"></p>
<p>æˆ‘ä»¬å¾—åˆ°äº†ä¸¤ä¸ªæ­£æ€åˆ†å¸ƒå˜é‡çš„æ•£ç‚¹å›¾ï¼Œçœ‹èµ·æ¥è¿™ä¸¤ä¸ªå˜é‡å¹¶ä¸ç›¸å…³ï¼Œå› ä¸ºä¸Šå›¾çš„å½¢çŠ¶å’Œè½´æ˜¯å¯¹é½çš„ã€‚</p>
<p>seaborn åº“çš„ <a href="https://seaborn.pydata.org/generated/seaborn.jointplot.html" target="_blank" rel="noopener"><i class="fa fa-external-link-square" aria-hidden="true"> <code>jointplot()</code></i></a> æ–¹æ³•åœ¨ç»˜åˆ¶æ•£ç‚¹å›¾çš„åŒæ—¶ä¼šç»˜åˆ¶ä¸¤å¼ ç›´æ–¹å›¾ï¼ŒæŸäº›æƒ…å½¢ä¸‹å®ƒä»¬å¯èƒ½ä¼šæ›´æœ‰ç”¨ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sns.jointplot(df[<span class="string">'Total day minutes'</span>], df[<span class="string">'Total night minutes'</span>])</span><br></pre></td></tr></table></figure>




<pre><code>&lt;seaborn.axisgrid.JointGrid at 0x139888cd0&gt;</code></pre><p><img src="data/output_70_1.png" alt="png"></p>
<p><code>jointplot()</code> æ–¹æ³•è¿˜å¯ä»¥ç»˜åˆ¶å¹³æ»‘è¿‡çš„æ•£ç‚¹ç›´æ–¹å›¾ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sns.jointplot(df[<span class="string">'Total day minutes'</span>], df[<span class="string">'Total night minutes'</span>], kind=<span class="string">'kde'</span>, color=<span class="string">'g'</span>)</span><br></pre></td></tr></table></figure>




<pre><code>&lt;seaborn.axisgrid.JointGrid at 0x139dc1890&gt;</code></pre><p><img src="data/output_72_1.png" alt="png"></p>
<p>ä¸Šå›¾åŸºæœ¬ä¸Šå°±æ˜¯ä¹‹å‰è®¨è®ºè¿‡çš„æ ¸å¯†åº¦å›¾çš„åŒå˜é‡ç‰ˆæœ¬ã€‚</p>
<h4 id="æ•£ç‚¹å›¾çŸ©é˜µ"><a href="#æ•£ç‚¹å›¾çŸ©é˜µ" class="headerlink" title="æ•£ç‚¹å›¾çŸ©é˜µ"></a>æ•£ç‚¹å›¾çŸ©é˜µ</h4><p>åœ¨æŸäº›æƒ…å½¢ä¸‹ï¼Œæˆ‘ä»¬å¯èƒ½æƒ³è¦ç»˜åˆ¶å¦‚ä¸‹æ‰€ç¤ºçš„æ•£ç‚¹å›¾çŸ©é˜µï¼ˆscatterplot matrixï¼‰ã€‚å®ƒçš„å¯¹è§’çº¿åŒ…å«å˜é‡çš„åˆ†å¸ƒï¼Œå¹¶ä¸”æ¯å¯¹å˜é‡çš„æ•£ç‚¹å›¾å¡«å……äº†çŸ©é˜µçš„å…¶ä½™éƒ¨åˆ†ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># %config InlineBackend.figure_format = 'png'</span></span><br><span class="line">sns.pairplot(df[numerical])</span><br></pre></td></tr></table></figure>




<pre><code>&lt;seaborn.axisgrid.PairGrid at 0x139cb5810&gt;</code></pre><p><img src="data/output_76_1.png" alt="png"></p>
<h4 id="æ•°é‡å’Œç±»åˆ«"><a href="#æ•°é‡å’Œç±»åˆ«" class="headerlink" title="æ•°é‡å’Œç±»åˆ«"></a>æ•°é‡å’Œç±»åˆ«</h4><p>ä¸ºäº†è®©å›¾å½¢æ›´æœ‰è¶£ä¸€ç‚¹ï¼Œå¯ä»¥å°è¯•ä»æ•°å€¼å’Œç±»åˆ«ç‰¹å¾çš„ç›¸äº’ä½œç”¨ä¸­å¾—åˆ°é¢„æµ‹ Churn çš„æ–°ä¿¡æ¯ï¼Œæ›´å…·ä½“åœ°ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹è¾“å…¥å˜é‡å’Œç›®æ ‡å˜é‡ Churn çš„å…³ç³»ã€‚ä½¿ç”¨ <a href="https://seaborn.pydata.org/generated/seaborn.lmplot.html" target="_blank" rel="noopener"><i class="fa fa-external-link-square" aria-hidden="true"> <code>lmplot()</code></i></a> æ–¹æ³•çš„ hue å‚æ•°æ¥æŒ‡å®šæ„Ÿå…´è¶£çš„ç±»åˆ«ç‰¹å¾ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sns.lmplot(<span class="string">'Total day minutes'</span>, <span class="string">'Total night minutes'</span>, data=df, hue=<span class="string">'Churn'</span>, fit_reg=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure>




<pre><code>&lt;seaborn.axisgrid.FacetGrid at 0x13e7df950&gt;</code></pre><p><img src="data/output_79_2.png" alt="png"></p>
<p>çœ‹èµ·æ¥ä¸å¿ å®å®¢æˆ·åå‘å³ä¸Šè§’ï¼Œä¹Ÿå°±æ˜¯å€¾å‘äºåœ¨ç™½å¤©å’Œå¤œé—´æ‰“æ›´å¤šç”µè¯çš„å®¢æˆ·ã€‚å½“ç„¶ï¼Œè¿™ä¸æ˜¯éå¸¸æ˜æ˜¾ï¼Œæˆ‘ä»¬ä¹Ÿä¸ä¼šåŸºäºè¿™ä¸€å›¾å½¢ä¸‹ä»»ä½•ç¡®å®šæ€§çš„ç»“è®ºã€‚</p>
<p>ç°åœ¨ï¼Œåˆ›å»ºç®±å½¢å›¾ï¼Œä»¥å¯è§†åŒ–å¿ å®å®¢æˆ·ï¼ˆChurn=0ï¼‰å’Œç¦»ç½‘å®¢æˆ·ï¼ˆChurn=1ï¼‰è¿™ä¸¤ä¸ªäº’æ–¥åˆ†ç»„ä¸­æ•°å€¼å˜é‡åˆ†å¸ƒçš„ç»Ÿè®¡æ•°æ®ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">numerical.append(<span class="string">'Customer service calls'</span>)</span><br><span class="line">print(numerical)</span><br><span class="line">fig, axes = plt.subplots(<span class="number">3</span>, <span class="number">4</span>, figsize=[<span class="number">10</span>, <span class="number">7</span>])</span><br><span class="line"><span class="keyword">for</span> index, feat <span class="keyword">in</span> enumerate(numerical):</span><br><span class="line">    ax = axes[int(index / <span class="number">4</span>), index % <span class="number">4</span>]</span><br><span class="line">    sns.boxplot(df[<span class="string">'Churn'</span>], df[feat], ax=ax)</span><br><span class="line">    ax.set_xlabel(<span class="string">''</span>)</span><br><span class="line">    ax.set_ylabel(feat)</span><br><span class="line">fig.tight_layout()</span><br></pre></td></tr></table></figure>

<pre><code>[&apos;Total day minutes&apos;, &apos;Total night minutes&apos;, &apos;Number vmail messages&apos;, &apos;Total eve calls&apos;, &apos;Account length&apos;, &apos;Total intl calls&apos;, &apos;Total eve minutes&apos;, &apos;Total night calls&apos;, &apos;Total day calls&apos;, &apos;Total intl minutes&apos;, &apos;Customer service calls&apos;, &apos;Customer service calls&apos;, &apos;Customer service calls&apos;, &apos;Customer service calls&apos;, &apos;Customer service calls&apos;, &apos;Customer service calls&apos;, &apos;Customer service calls&apos;, &apos;Customer service calls&apos;]



---------------------------------------------------------------------------

IndexError                                Traceback (most recent call last)

&lt;ipython-input-47-539701aff8ff&gt; in &lt;module&gt;
      3 fig, axes = plt.subplots(3, 4, figsize=[10, 7])
      4 for index, feat in enumerate(numerical):
----&gt; 5     ax = axes[int(index / 4), index % 4]
      6     sns.boxplot(df[&apos;Churn&apos;], df[feat], ax=ax)
      7     ax.set_xlabel(&apos;&apos;)


IndexError: index 3 is out of bounds for axis 0 with size 3</code></pre><p><img src="data/output_82_2.png" alt="png"></p>
<p>ä¸Šé¢çš„å›¾è¡¨è¡¨æ˜ï¼Œä¸¤ç»„ä¹‹é—´åˆ†æ­§æœ€å¤§çš„åˆ†å¸ƒæ˜¯è¿™ä¸‰ä¸ªå˜é‡ï¼šTotal day minutes æ—¥é€šè¯åˆ†é’Ÿæ•°ã€Customer service calls å®¢æœå‘¼å«æ•°ã€Number vmail messages è¯­éŸ³é‚®ä»¶æ•°ã€‚åœ¨åç»­çš„è¯¾ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†å­¦ä¹ å¦‚ä½•ä½¿ç”¨éšæœºæ£®æ—ï¼ˆRandom Forestï¼‰æˆ–æ¢¯åº¦æå‡ï¼ˆGradient Boostingï¼‰æ¥åˆ¤å®šç‰¹å¾å¯¹åˆ†ç±»çš„é‡è¦æ€§ï¼Œå±Šæ—¶å¯ä»¥æ¸…æ™°åœ°çœ‹åˆ°ï¼Œå‰ä¸¤ä¸ªç‰¹å¾å¯¹äºç¦»ç½‘é¢„æµ‹æ¨¡å‹è€Œè¨€ç¡®å®éå¸¸é‡è¦ã€‚</p>
<p>åˆ›å»ºç®±å‹å›¾å’Œæç´å½¢å›¾ï¼ŒæŸ¥çœ‹å¿ å®å®¢æˆ·å’Œä¸å¿ å®å®¢æˆ·çš„æ—¥é€šè¯åˆ†é’Ÿæ•°ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">_, axes = plt.subplots(<span class="number">2</span>, <span class="number">2</span>, sharex=<span class="literal">True</span>, sharey=<span class="literal">True</span>, figsize=[<span class="number">10</span>, <span class="number">8</span>])</span><br><span class="line">sns.boxplot(x=<span class="string">'Churn'</span>, y=<span class="string">'Total day minutes'</span>, data=df, ax=axes[<span class="number">0</span>][<span class="number">0</span>])</span><br><span class="line">sns.violinplot(x=<span class="string">'Churn'</span>, y=<span class="string">"Total day minutes"</span>, data=df, ax=axes[<span class="number">0</span>][<span class="number">1</span>])</span><br><span class="line">sns.boxplot(x=<span class="string">'Churn'</span>, y=<span class="string">'Total night minutes'</span>, data=df, ax=axes[<span class="number">1</span>][<span class="number">0</span>])</span><br><span class="line">sns.violinplot(x=<span class="string">'Churn'</span>, y=<span class="string">"Total night minutes"</span>, data=df, ax=axes[<span class="number">1</span>][<span class="number">1</span>])</span><br></pre></td></tr></table></figure>




<pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x140f70290&gt;</code></pre><p><img src="data/output_85_1.png" alt="png"></p>
<p>ä¸Šå›¾è¡¨æ˜ï¼Œä¸å¿ å®å®¢æˆ·å€¾å‘äºæ‰“æ›´å¤šçš„ç”µè¯ã€‚</p>
<p>æˆ‘ä»¬è¿˜å¯ä»¥å‘ç°ä¸€ä¸ªæœ‰è¶£çš„ä¿¡æ¯ï¼šå¹³å‡è€Œè¨€ï¼Œç¦»ç½‘å®¢æˆ·æ˜¯é€šè®¯æœåŠ¡æ›´æ´»è·ƒçš„ç”¨æˆ·ã€‚æˆ–è®¸æ˜¯ä»–ä»¬å¯¹è¯è´¹ä¸æ»¡æ„ï¼Œæ‰€ä»¥é¢„é˜²ç¦»ç½‘çš„ä¸€ä¸ªå¯èƒ½æªæ–½æ˜¯é™ä½é€šè¯è´¹ã€‚å½“ç„¶ï¼Œå…¬å¸éœ€è¦è¿›è¡Œé¢å¤–çš„ç»æµåˆ†æï¼Œä»¥æŸ¥æ˜è¿™æ ·åšæ˜¯å¦çœŸçš„æœ‰åˆ©ã€‚</p>
<p>å½“æƒ³è¦ä¸€æ¬¡æ€§åˆ†æä¸¤ä¸ªç±»åˆ«ç»´åº¦ä¸‹çš„æ•°é‡å˜é‡æ—¶ï¼Œå¯ä»¥ç”¨ seaborn åº“çš„ <a href="https://seaborn.pydata.org/generated/seaborn.factorplot.html" target="_blank" rel="noopener"><i class="fa fa-external-link-square" aria-hidden="true"> <code>catplot()</code></i></a> å‡½æ•°ã€‚ä¾‹å¦‚ï¼Œåœ¨åŒä¸€å›¾å½¢ä¸­å¯è§†åŒ– Total day minutes æ—¥é€šè¯åˆ†é’Ÿæ•° å’Œä¸¤ä¸ªç±»åˆ«å˜é‡ï¼ˆChurn å’Œ Customer service callsï¼‰çš„ç›¸äº’ä½œç”¨ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sns.catplot(x=<span class="string">'Churn'</span>, y=<span class="string">'Total day minutes'</span>, col=<span class="string">'Customer service calls'</span>,</span><br><span class="line">          data=df[df[<span class="string">'Customer service calls'</span>] &lt; <span class="number">8</span>], kind=<span class="string">'box'</span>, col_wrap=<span class="number">4</span>, height=<span class="number">3</span>, aspect=<span class="number">.8</span>)</span><br></pre></td></tr></table></figure>




<pre><code>&lt;seaborn.axisgrid.FacetGrid at 0x140728250&gt;</code></pre><p><img src="data/output_89_1.png" alt="png"></p>
<p>ä¸Šå›¾è¡¨æ˜ï¼Œä»ç¬¬ 4 æ¬¡å®¢æœå‘¼å«å¼€å§‹ï¼ŒTotal day minutes æ—¥é€šè¯åˆ†é’Ÿæ•° å¯èƒ½ä¸å†æ˜¯å®¢æˆ·ç¦»ç½‘ï¼ˆChurn==1ï¼‰çš„ä¸»è¦å› ç´ ã€‚ä¹Ÿè®¸ï¼Œé™¤äº†æˆ‘ä»¬ä¹‹å‰çŒœæµ‹çš„è¯è´¹åŸå› ï¼Œè¿˜æœ‰å…¶ä»–é—®é¢˜å¯¼è‡´å®¢æˆ·å¯¹æœåŠ¡ä¸æ»¡æ„ï¼Œè¿™å¯èƒ½ä¼šå¯¼è‡´æ—¥é€šè¯åˆ†é’Ÿæ•°æ›´å°‘ã€‚</p>
<h4 id="ç±»åˆ«ä¸ç±»åˆ«"><a href="#ç±»åˆ«ä¸ç±»åˆ«" class="headerlink" title="ç±»åˆ«ä¸ç±»åˆ«"></a>ç±»åˆ«ä¸ç±»åˆ«</h4><p>æ­£å¦‚ä¹‹å‰æåˆ°çš„ï¼Œå˜é‡ Customer service calls å®¢æœå‘¼å«æ•° çš„é‡å¤å€¼å¾ˆå¤šï¼Œå› æ­¤ï¼Œæ—¢å¯ä»¥çœ‹æˆæ•°å€¼å˜é‡ï¼Œä¹Ÿå¯ä»¥çœ‹æˆæœ‰åºç±»åˆ«å˜é‡ã€‚ä¹‹å‰å·²é€šè¿‡è®¡æ•°å›¾ï¼ˆcount plotï¼‰æŸ¥çœ‹è¿‡å®ƒçš„åˆ†å¸ƒäº†ï¼Œç°åœ¨æˆ‘ä»¬æ„Ÿå…´è¶£çš„æ˜¯è¿™ä¸€æœ‰åºç‰¹å¾å’Œç›®æ ‡å˜é‡ Churn ç¦»ç½‘ç‡ ä¹‹é—´çš„å…³ç³»ã€‚</p>
<p>ä½¿ç”¨ <code>countplot()</code> æ–¹æ³•æŸ¥çœ‹å®¢æœå‘¼å«æ•°çš„åˆ†å¸ƒï¼Œè¿™æ¬¡ä¼ å…¥ <code>hue=Churn</code> å‚æ•°ï¼Œä»¥ä¾¿åœ¨å›¾å½¢ä¸­åŠ å…¥ç±»åˆ«ç»´åº¦ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sns.countplot(x=<span class="string">'Customer service calls'</span>, hue=<span class="string">'Churn'</span>, data=df[df[<span class="string">"Customer service calls"</span>] &lt; <span class="number">10</span>])</span><br></pre></td></tr></table></figure>




<pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x140cb7990&gt;</code></pre><p><img src="data/output_94_1.png" alt="png"></p>
<p>ä¸Šå›¾è¡¨æ˜ï¼Œå‘¼å«å®¢æœè¾¾åˆ° 4 æ¬¡ä»¥ä¸Šåï¼Œç¦»ç½‘ç‡æ˜¾è‘—å¢åŠ äº†ã€‚</p>
<p>ä½¿ç”¨ <code>countplot()</code> æ–¹æ³•æŸ¥çœ‹ Churn ç¦»ç½‘ç‡ å’ŒäºŒå…ƒç‰¹å¾ International plan å›½é™…å¥—é¤ã€Voice mail plan è¯­éŸ³é‚®ä»¶å¥—é¤ çš„å…³ç³»ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">_, axes = plt.subplots(<span class="number">1</span>, <span class="number">2</span>, sharey=<span class="literal">True</span>, figsize=(<span class="number">10</span>, <span class="number">4</span>))</span><br><span class="line"></span><br><span class="line">sns.countplot(x=<span class="string">'International plan'</span>, hue=<span class="string">'Churn'</span>, data=df, ax=axes[<span class="number">0</span>])</span><br><span class="line">sns.countplot(x=<span class="string">'Voice mail plan'</span>, hue=<span class="string">'Churn'</span>, data=df, ax=axes[<span class="number">1</span>])</span><br></pre></td></tr></table></figure>




<pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x142344290&gt;</code></pre><p><img src="data/output_97_1.png" alt="png"></p>
<p>ä¸Šå›¾è¡¨æ˜ï¼Œå¼€é€šå›½é™…å¥—é¤åï¼Œç¦»ç½‘ç‡ä¼šé«˜å¾ˆå¤šï¼Œå³ International plan æ˜¯å¦å¼€é€šå›½é™…å¥—é¤ æ˜¯ä¸€ä¸ªé‡è¦çš„ç‰¹å¾ã€‚æˆ‘ä»¬åœ¨ Vocie mail plan è¯­éŸ³é‚®ä»¶å¥—é¤ ç‰¹å¾ä¸Šæ²¡æœ‰è§‚å¯Ÿåˆ°ç±»ä¼¼çš„æ•ˆæœã€‚</p>
<h4 id="äº¤å‰è¡¨"><a href="#äº¤å‰è¡¨" class="headerlink" title="äº¤å‰è¡¨"></a>äº¤å‰è¡¨</h4><p>é™¤äº†ä½¿ç”¨å›¾å½¢è¿›è¡Œç±»åˆ«åˆ†æä¹‹å¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ç»Ÿè®¡å­¦çš„ä¼ ç»Ÿå·¥å…·ï¼šäº¤å‰è¡¨ï¼ˆcross tabulationï¼‰ï¼Œå³ä½¿ç”¨è¡¨æ ¼å½¢å¼è¡¨ç¤ºå¤šä¸ªç±»åˆ«å˜é‡çš„é¢‘ç‡åˆ†å¸ƒã€‚é€šè¿‡å®ƒå¯ä»¥æŸ¥çœ‹æŸä¸€åˆ—æˆ–æŸä¸€è¡Œä»¥äº†è§£æŸä¸ªå˜é‡åœ¨å¦ä¸€å˜é‡çš„ä½œç”¨ä¸‹çš„åˆ†å¸ƒæƒ…å†µã€‚</p>
<p>é€šè¿‡äº¤å‰è¡¨æŸ¥çœ‹ Churn ç¦»ç½‘ç‡ å’Œç±»åˆ«å˜é‡ State å· çš„å…³ç³»ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.crosstab(df[<span class="string">'State'</span>], df[<span class="string">'Churn'</span>]).T</span><br></pre></td></tr></table></figure>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}</code></pre><p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>State</th>
      <th>AK</th>
      <th>AL</th>
      <th>AR</th>
      <th>AZ</th>
      <th>CA</th>
      <th>CO</th>
      <th>CT</th>
      <th>DC</th>
      <th>DE</th>
      <th>FL</th>
      <th>...</th>
      <th>SD</th>
      <th>TN</th>
      <th>TX</th>
      <th>UT</th>
      <th>VA</th>
      <th>VT</th>
      <th>WA</th>
      <th>WI</th>
      <th>WV</th>
      <th>WY</th>
    </tr>
    <tr>
      <th>Churn</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>False</th>
      <td>49</td>
      <td>72</td>
      <td>44</td>
      <td>60</td>
      <td>25</td>
      <td>57</td>
      <td>62</td>
      <td>49</td>
      <td>52</td>
      <td>55</td>
      <td>...</td>
      <td>52</td>
      <td>48</td>
      <td>54</td>
      <td>62</td>
      <td>72</td>
      <td>65</td>
      <td>52</td>
      <td>71</td>
      <td>96</td>
      <td>68</td>
    </tr>
    <tr>
      <th>True</th>
      <td>3</td>
      <td>8</td>
      <td>11</td>
      <td>4</td>
      <td>9</td>
      <td>9</td>
      <td>12</td>
      <td>5</td>
      <td>9</td>
      <td>8</td>
      <td>...</td>
      <td>8</td>
      <td>5</td>
      <td>18</td>
      <td>10</td>
      <td>5</td>
      <td>8</td>
      <td>14</td>
      <td>7</td>
      <td>10</td>
      <td>9</td>
    </tr>
  </tbody>
</table>
<p>2 rows Ã— 51 columns</p>
</div>



<p>ä¸Šè¡¨æ˜¾ç¤ºï¼ŒState å· æœ‰ 51 ä¸ªä¸åŒçš„å€¼ï¼Œå¹¶ä¸”æ¯ä¸ªå·åªæœ‰ 3 åˆ° 17 ä¸ªå®¢æˆ·æŠ›å¼ƒäº†è¿è¥å•†ã€‚é€šè¿‡ <code>groupby()</code> æ–¹æ³•è®¡ç®—æ¯ä¸ªå·çš„ç¦»ç½‘ç‡ï¼Œç”±é«˜åˆ°ä½æ’åˆ—ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.groupby([<span class="string">'State'</span>])[<span class="string">'Churn'</span>].agg([np.mean]).sort_values(by=<span class="string">'mean'</span>, ascending=<span class="literal">False</span>).T</span><br></pre></td></tr></table></figure>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}</code></pre><p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>State</th>
      <th>NJ</th>
      <th>CA</th>
      <th>TX</th>
      <th>MD</th>
      <th>SC</th>
      <th>MI</th>
      <th>MS</th>
      <th>NV</th>
      <th>WA</th>
      <th>ME</th>
      <th>...</th>
      <th>RI</th>
      <th>WI</th>
      <th>IL</th>
      <th>NE</th>
      <th>LA</th>
      <th>IA</th>
      <th>VA</th>
      <th>AZ</th>
      <th>AK</th>
      <th>HI</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>mean</th>
      <td>0.264706</td>
      <td>0.264706</td>
      <td>0.25</td>
      <td>0.242857</td>
      <td>0.233333</td>
      <td>0.219178</td>
      <td>0.215385</td>
      <td>0.212121</td>
      <td>0.212121</td>
      <td>0.209677</td>
      <td>...</td>
      <td>0.092308</td>
      <td>0.089744</td>
      <td>0.086207</td>
      <td>0.081967</td>
      <td>0.078431</td>
      <td>0.068182</td>
      <td>0.064935</td>
      <td>0.0625</td>
      <td>0.057692</td>
      <td>0.056604</td>
    </tr>
  </tbody>
</table>
<p>1 rows Ã— 51 columns</p>
</div>



<p>ä¸Šè¡¨æ˜¾ç¤ºï¼Œæ–°æ³½è¥¿å’ŒåŠ åˆ©ç¦å°¼äºšçš„ç¦»ç½‘ç‡è¶…è¿‡äº† 25%ï¼Œå¤å¨å¤·å’Œé˜¿æ‹‰æ–¯åŠ çš„ç¦»ç½‘ç‡åˆ™ä¸åˆ° 6%ã€‚ç„¶è€Œï¼Œè¿™äº›ç»“è®ºæ˜¯åŸºäºæå°‘çš„æ ·æœ¬å¾—å‡ºçš„ï¼Œå¯èƒ½ä»…é€‚ç”¨äºè¿™ä¸€ç‰¹å®šæ•°æ®é›†ï¼Œä¸å¤ªå…·æœ‰æ³›ç”¨æ€§ã€‚</p>
<h3 id="å…¨å±€æ•°æ®é›†å¯è§†åŒ–"><a href="#å…¨å±€æ•°æ®é›†å¯è§†åŒ–" class="headerlink" title="å…¨å±€æ•°æ®é›†å¯è§†åŒ–"></a>å…¨å±€æ•°æ®é›†å¯è§†åŒ–</h3><p>ä¸Šé¢æˆ‘ä»¬ä¸€ç›´åœ¨ç ”ç©¶æ•°æ®é›†çš„ä¸åŒæ–¹é¢ï¼ˆfacetï¼‰ï¼Œé€šè¿‡çŒœæµ‹æœ‰è¶£çš„ç‰¹å¾å¹¶ä¸€æ¬¡é€‰æ‹©å°‘é‡ç‰¹å¾è¿›è¡Œå¯è§†åŒ–ã€‚å¦‚æœæˆ‘ä»¬æƒ³ä¸€æ¬¡æ€§æ˜¾ç¤ºæ‰€æœ‰ç‰¹å¾å¹¶ä»ç„¶èƒ½å¤Ÿè§£é‡Šç”Ÿæˆçš„å¯è§†åŒ–ï¼Œè¯¥æ€ä¹ˆåŠï¼Ÿ</p>
<h4 id="é™ç»´"><a href="#é™ç»´" class="headerlink" title="é™ç»´"></a>é™ç»´</h4><p>å¤§å¤šæ•°ç°å®ä¸–ç•Œçš„æ•°æ®é›†æœ‰å¾ˆå¤šç‰¹å¾ï¼Œæ¯ä¸€ä¸ªç‰¹å¾éƒ½å¯ä»¥è¢«çœ‹æˆæ•°æ®ç©ºé—´çš„ä¸€ä¸ªç»´åº¦ã€‚å› æ­¤ï¼Œæˆ‘ä»¬ç»å¸¸éœ€è¦å¤„ç†é«˜ç»´æ•°æ®é›†ï¼Œç„¶è€Œå¯è§†åŒ–æ•´ä¸ªé«˜ç»´æ•°æ®é›†ç›¸å½“éš¾ã€‚ä¸ºäº†ä»æ•´ä½“ä¸ŠæŸ¥çœ‹ä¸€ä¸ªæ•°æ®é›†ï¼Œéœ€è¦åœ¨ä¸æŸå¤±å¾ˆå¤šæ•°æ®ä¿¡æ¯çš„å‰æä¸‹ï¼Œé™ä½ç”¨äºå¯è§†åŒ–çš„ç»´åº¦ã€‚è¿™ä¸€ä»»åŠ¡è¢«ç§°ä¸ºé™ç»´ï¼ˆdimensionality reductionï¼‰ã€‚é™ç»´æ˜¯ä¸€ä¸ªæ— ç›‘ç£å­¦ä¹ ï¼ˆunsupervised learningï¼‰é—®é¢˜ï¼Œå› ä¸ºå®ƒéœ€è¦åœ¨ä¸å€ŸåŠ©ä»»ä½•ç›‘ç£è¾“å…¥ï¼ˆå¦‚æ ‡ç­¾ï¼‰çš„å‰æä¸‹ï¼Œä»æ•°æ®è‡ªèº«å¾—åˆ°æ–°çš„ä½ç»´ç‰¹å¾ã€‚</p>
<p>ä¸»æˆåˆ†åˆ†æï¼ˆPrincipal Component Analysis, PCAï¼‰æ˜¯ä¸€ä¸ªè‘—åçš„é™ç»´æ–¹æ³•ï¼Œæˆ‘ä»¬ä¼šåœ¨ä¹‹åçš„è¯¾ç¨‹ä¸­è®¨è®ºå®ƒã€‚ä½†ä¸»æˆåˆ†åˆ†æçš„å±€é™æ€§åœ¨äºï¼Œå®ƒæ˜¯çº¿æ€§ï¼ˆlinearï¼‰ç®—æ³•ï¼Œè¿™æ„å‘³ç€å¯¹æ•°æ®æœ‰æŸäº›ç‰¹å®šçš„é™åˆ¶ã€‚</p>
<p>ä¸çº¿æ€§æ–¹æ³•ç›¸å¯¹çš„ï¼Œæœ‰è®¸å¤šéçº¿æ€§æ–¹æ³•ï¼Œç»Ÿç§°æµå½¢å­¦ä¹ ï¼ˆManifold Learningï¼‰ã€‚è‘—åçš„æµå½¢å­¦ä¹ æ–¹æ³•ä¹‹ä¸€æ˜¯ t-SNEã€‚</p>
<h3 id="å®éªŒæ€»ç»“"><a href="#å®éªŒæ€»ç»“" class="headerlink" title="å®éªŒæ€»ç»“"></a>å®éªŒæ€»ç»“</h3><p>æœ¬ç« èŠ‚é¦–å…ˆä»‹ç»äº† Pandasã€Matplotlib å’Œ seaborn åº“çš„ä¸€äº›å¸¸ç”¨å¯è§†åŒ–æ–¹æ³•ï¼Œå¹¶å¯¹å®¢æˆ·ç¦»ç½‘æ•°æ®é›†è¿›è¡Œäº†å¯è§†åŒ–åˆ†æå’Œ t-SNE é™ç»´ã€‚å¯è§†åŒ–æ˜¯ä¸€ä¸ªç›¸å¯¹å¿«æ·çš„ä»æ•°æ®ä¸­æŒ–æ˜ä¿¡æ¯çš„æ‰‹æ®µï¼Œå› æ­¤ï¼Œå­¦ä¹ è¿™ä¸€æŠ€æœ¯å¹¶å°†å…¶çº³å…¥ä½ çš„æ—¥å¸¸æœºå™¨å­¦ä¹ å·¥å…·ç®±ï¼Œæ˜¯å¾ˆæœ‰å¿…è¦çš„ã€‚</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>





  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/58/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/58/">58</a><span class="page-number current">59</span><a class="page-number" href="/page/60/">60</a><span class="space">&hellip;</span><a class="page-number" href="/page/70/">70</a><a class="extend next" rel="next" href="/page/60/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



      

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      const activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      const commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

    </div>
  </main>

  <footer class="footer">
    <div class="footer-inner">
      

      

<div class="copyright">
  
  &copy; 2018 â€“ 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Edlison</span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="Total Visitors">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="Total Views">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>

    </div>
  </footer>

  
  <script src="//cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  
  <script>
    (function(){
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      bp.src = (curProtocol === 'https') ? 'https://zz.bdstatic.com/linksubmit/push.js' : 'http://push.zhanzhang.baidu.com/push.js';
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
    })();
  </script>


















  
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>








  

  
      <script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              const target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    const script = document.createElement('script');
    script.src = '//cdn.jsdelivr.net/npm/mathjax@3.1.2/es5/tex-mml-chtml.js';
    script.defer = true;
    document.head.appendChild(script);
  } else {
    MathJax.startup.document.state(0);
    MathJax.typesetClear();
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  

</body>
</html>
